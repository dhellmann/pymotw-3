<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>tempfile — Temporary File System Objects &mdash; PyMOTW 3</title>

    <link rel="stylesheet" href="../_static/pure-min.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pymotw.css" type="text/css">

    <link rel="shortcut icon" type="image/png" href="../_static/favicon.png">

    <link rel="alternate" type="application/atom+xml"
          title="Doug Hellmann"
          href="http://feeds.doughellmann.com/DougHellmann" />
    <link rel="alternate" type="application/atom+xml"
          title="PyMOTW Updates"
          href="http://feeds.doughellmann.com/PyMOTW" />

    <meta name="verify-v1" content="5saTcOa2HLac4V85yUg3SARfun1PqT5Upu7IR/6fpv4="/>

  </head>
  <body>

    <div class="pure-menu pure-menu-open pure-menu-horizontal" id="site-menu">
      <a class="pure-menu-heading" href="../index.html"><img src="../_static/logo.png"> PyMOTW-3</a>

      <ul id="top-menu">
        <li class="pure-menu-selected"><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
        <li class="pure-menu-selected"><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
        <li class="pure-menu-selected"><a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a></a>
        <li class="pure-menu-selected"><a class="sociallink" href="http://feeds.doughellmann.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a></li>
      </ul>

    </div>

    <div class="pure-menu pure-menu-open pure-menu-vertical" id="breadcrumbs-menu">
      
      <ul id="breadcrumbs">
        <li class="pure-menu-selected"><a href="../file_access.html"><i class="fa fa-arrow-circle-up"></i> The File System</a></li>
      </ul>
    </div>

    <div class="pure-g-r" id="content-container">

      <div class="pure-u-3-4">
        <div class="content">
          
  <div class="section" id="module-tempfile">
<span id="tempfile-temporary-file-system-objects"></span><h1>tempfile — Temporary File System Objects<a class="headerlink" href="#module-tempfile" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Create temporary file system objects.</td>
</tr>
</tbody>
</table>
<p>Creating temporary files with unique names securely, so they cannot be
guessed by someone wanting to break the application or steal the data,
is challenging. The <code class="docutils literal notranslate"><span class="pre">tempfile</span></code> module provides several functions
for creating temporary file system resources securely.
<code class="docutils literal notranslate"><span class="pre">TemporaryFile()</span></code> opens and returns an unnamed file,
<code class="docutils literal notranslate"><span class="pre">NamedTemporaryFile()</span></code> opens and returns a named file,
<code class="docutils literal notranslate"><span class="pre">SpooledTemporaryFile</span></code> holds its content in memory before
writing to disk, and <code class="docutils literal notranslate"><span class="pre">TemporaryDirectory</span></code> is a context manager
that removes the directory when the context is closed.</p>
<div class="section" id="temporary-files">
<h2>Temporary Files<a class="headerlink" href="#temporary-files" title="Permalink to this headline">¶</a></h2>
<p>Applications that need temporary files to store data, without needing
to share that file with other programs, should use the
<code class="docutils literal notranslate"><span class="pre">TemporaryFile()</span></code> function to create the files. The function
creates a file, and on platforms where it is possible, unlinks it
immediately. This makes it impossible for another program to find or
open the file, since there is no reference to it in the file system
table. The file created by <code class="docutils literal notranslate"><span class="pre">TemporaryFile()</span></code> is removed
automatically when it is closed, whether by calling <code class="docutils literal notranslate"><span class="pre">close()</span></code> or
by using the context manager API and <code class="docutils literal notranslate"><span class="pre">with</span></code> statement.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">tempfile_TemporaryFile.py</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Building a filename with PID:&#39;</span><span class="p">)</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;/tmp/guess_my_name.</span><span class="si">{}</span><span class="s1">.txt&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w+b&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">temp</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temp:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">{!r}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temp.name:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">{!r}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

<span class="c1"># Clean up the temporary file yourself.</span>
<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TemporaryFile:&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryFile</span><span class="p">()</span> <span class="k">as</span> <span class="n">temp</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temp:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">{!r}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temp.name:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">{!r}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

<span class="c1"># Automatically cleans up the file.</span>
</pre></div>
</div>
</div>
<p>This example illustrates the difference in creating a temporary file
using a common pattern for making up a name, versus using the
<code class="docutils literal notranslate"><span class="pre">TemporaryFile()</span></code> function. The file returned by
<code class="docutils literal notranslate"><span class="pre">TemporaryFile()</span></code> has no name.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 tempfile_TemporaryFile.py

Building a filename with PID:
temp:
  &lt;_io.BufferedRandom name=&#39;/tmp/guess_my_name.12151.txt&#39;&gt;
temp.name:
  &#39;/tmp/guess_my_name.12151.txt&#39;

TemporaryFile:
temp:
  &lt;_io.BufferedRandom name=4&gt;
temp.name:
  4
</pre></div>
</div>
<p>By default, the file handle is created with mode <code class="docutils literal notranslate"><span class="pre">'w+b'</span></code> so it
behaves consistently on all platforms and the caller can write to it
and read from it.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">tempfile_TemporaryFile_binary.py</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryFile</span><span class="p">()</span> <span class="k">as</span> <span class="n">temp</span><span class="p">:</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Some data&#39;</span><span class="p">)</span>

    <span class="n">temp</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p>After writing, the file handle must be “rewound” using <code class="docutils literal notranslate"><span class="pre">seek()</span></code>
in order to read the data back from it.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 tempfile_TemporaryFile_binary.py

b&#39;Some data&#39;
</pre></div>
</div>
<p>To open the file in text mode, set <code class="docutils literal notranslate"><span class="pre">mode</span></code> to <code class="docutils literal notranslate"><span class="pre">'w+t'</span></code> when the file
is created.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">tempfile_TemporaryFile_text.py</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tempfile</span>

<span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryFile</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w+t&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">([</span><span class="s1">&#39;first</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;second</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">])</span>

    <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p>The file handle treats the data as text.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 tempfile_TemporaryFile_text.py

first
second
</pre></div>
</div>
</div>
<div class="section" id="named-files">
<h2>Named Files<a class="headerlink" href="#named-files" title="Permalink to this headline">¶</a></h2>
<p>There are situations where having a named temporary file is
important. For applications spanning multiple processes, or even
hosts, naming the file is the simplest way to pass it between parts of
the application. The <code class="docutils literal notranslate"><span class="pre">NamedTemporaryFile()</span></code> function creates a
file without unlinking it, so it retains its name (accessed with the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code> attribute).</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">tempfile_NamedTemporaryFile.py</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">()</span> <span class="k">as</span> <span class="n">temp</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temp:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">{!r}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temp.name:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">{!r}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

    <span class="n">f</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exists after close:&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">exists</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p>The file is removed after the handle is closed.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 tempfile_NamedTemporaryFile.py

temp:
  &lt;tempfile._TemporaryFileWrapper object at 0x1011b2d30&gt;
temp.name:
  &#39;/var/folders/5q/8gk0wq888xlggz008k8dr7180000hg/T/tmps4qh5zde&#39;
Exists after close: False
</pre></div>
</div>
</div>
<div class="section" id="spooled-files">
<h2>Spooled Files<a class="headerlink" href="#spooled-files" title="Permalink to this headline">¶</a></h2>
<p>For temporary files containing relatively small amounts of data, it is
likely to be more efficient to use a <code class="docutils literal notranslate"><span class="pre">SpooledTemporaryFile</span></code> because
it holds the file contents in memory using a <code class="docutils literal notranslate"><span class="pre">io.BytesIO</span></code> or
<code class="docutils literal notranslate"><span class="pre">io.StringIO</span></code> buffer until they reach a threshold size. When the
amount of data passes the threshold, it is “rolled over” and written
to disk, and then the buffer is replaced with a normal
<code class="docutils literal notranslate"><span class="pre">TemporaryFile()</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">tempfile_SpooledTemporaryFile.py</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tempfile</span>

<span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">SpooledTemporaryFile</span><span class="p">(</span><span class="n">max_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                   <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w+t&#39;</span><span class="p">,</span>
                                   <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">temp</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temp: </span><span class="si">{!r}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">temp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;This line is repeated over and over.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">_rolled</span><span class="p">,</span> <span class="n">temp</span><span class="o">.</span><span class="n">_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This example uses private attributes of the <code class="docutils literal notranslate"><span class="pre">SpooledTemporaryFile</span></code>
to determine when the rollover to disk has happened. It is not
normally necessary to check this status except when tuning the buffer
size.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 tempfile_SpooledTemporaryFile.py

temp: &lt;tempfile.SpooledTemporaryFile object at 0x1007b2c88&gt;
False &lt;_io.StringIO object at 0x1007a3d38&gt;
False &lt;_io.StringIO object at 0x1007a3d38&gt;
True &lt;_io.TextIOWrapper name=4 mode=&#39;w+t&#39; encoding=&#39;utf-8&#39;&gt;
</pre></div>
</div>
<p>To explicitly cause the buffer to be written to disk, call the
<code class="docutils literal notranslate"><span class="pre">rollover()</span></code> or <code class="docutils literal notranslate"><span class="pre">fileno()</span></code> methods.</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">tempfile_SpooledTemporaryFile_explicit.py</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tempfile</span>

<span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">SpooledTemporaryFile</span><span class="p">(</span><span class="n">max_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                                   <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w+t&#39;</span><span class="p">,</span>
                                   <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">temp</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temp: </span><span class="si">{!r}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">temp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;This line is repeated over and over.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">_rolled</span><span class="p">,</span> <span class="n">temp</span><span class="o">.</span><span class="n">_file</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rolling over&#39;</span><span class="p">)</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">rollover</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">_rolled</span><span class="p">,</span> <span class="n">temp</span><span class="o">.</span><span class="n">_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>In this example, because the buffer size is so much larger than the
amount of data, no file would be created on disk except that
<code class="docutils literal notranslate"><span class="pre">rollover()</span></code> was called.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 tempfile_SpooledTemporaryFile_explicit.py

temp: &lt;tempfile.SpooledTemporaryFile object at 0x1007b2c88&gt;
False &lt;_io.StringIO object at 0x1007a3d38&gt;
False &lt;_io.StringIO object at 0x1007a3d38&gt;
False &lt;_io.StringIO object at 0x1007a3d38&gt;
rolling over
True &lt;_io.TextIOWrapper name=4 mode=&#39;w+t&#39; encoding=&#39;utf-8&#39;&gt;
</pre></div>
</div>
</div>
<div class="section" id="temporary-directories">
<h2>Temporary Directories<a class="headerlink" href="#temporary-directories" title="Permalink to this headline">¶</a></h2>
<p>When several temporary files are needed, it may be more convenient to
create a single temporary directory with <code class="docutils literal notranslate"><span class="pre">TemporaryDirectory</span></code>
and open all of the files in that directory.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">tempfile_TemporaryDirectory.py</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">directory_name</span><span class="p">:</span>
    <span class="n">the_dir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">directory_name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">the_dir</span><span class="p">)</span>
    <span class="n">a_file</span> <span class="o">=</span> <span class="n">the_dir</span> <span class="o">/</span> <span class="s1">&#39;a_file.txt&#39;</span>
    <span class="n">a_file</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s1">&#39;This file is deleted.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Directory exists after?&#39;</span><span class="p">,</span> <span class="n">the_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Contents after:&#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">the_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<p>The context manager produces the name of the directory, which can then
be used within the context block to build other file names.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 tempfile_TemporaryDirectory.py

/var/folders/5q/8gk0wq888xlggz008k8dr7180000hg/T/tmp_urhiioj
Directory exists after? False
Contents after: []
</pre></div>
</div>
</div>
<div class="section" id="predicting-names">
<h2>Predicting Names<a class="headerlink" href="#predicting-names" title="Permalink to this headline">¶</a></h2>
<p>While less secure than strictly anonymous temporary files, including a
predictable portion in the name makes it possible to find the file and
examine it for debugging purposes. All of the functions described so
far take three arguments to control the filenames to some
degree. Names are generated using the formula:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>dir + prefix + random + suffix
</pre></div>
</div>
<p>All of the values except <code class="docutils literal notranslate"><span class="pre">random</span></code> can be passed as arguments to the
functions for creating temporary files or directories.</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">tempfile_NamedTemporaryFile_args.py</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tempfile</span>

<span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;_suffix&#39;</span><span class="p">,</span>
                                 <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;prefix_&#39;</span><span class="p">,</span>
                                 <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;/tmp&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">temp</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temp:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temp.name:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">,</span> <span class="n">temp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">prefix</span></code> and <code class="docutils literal notranslate"><span class="pre">suffix</span></code> arguments are combined with a random string
of characters to build the filename, and the <code class="docutils literal notranslate"><span class="pre">dir</span></code> argument is taken
as-is and used as the location of the new file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 tempfile_NamedTemporaryFile_args.py

temp:
   &lt;tempfile._TemporaryFileWrapper object at 0x1018b2d68&gt;
temp.name:
   /tmp/prefix_q6wd5czl_suffix
</pre></div>
</div>
</div>
<div class="section" id="temporary-file-location">
<h2>Temporary File Location<a class="headerlink" href="#temporary-file-location" title="Permalink to this headline">¶</a></h2>
<p>If an explicit destination is not given using the <code class="docutils literal notranslate"><span class="pre">dir</span></code> argument, the
path used for the temporary files will vary based on the current
platform and settings. The <code class="docutils literal notranslate"><span class="pre">tempfile</span></code> module includes two
functions for querying the settings being used at runtime.</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">tempfile_settings.py</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tempfile</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gettempdir():&#39;</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gettempprefix():&#39;</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempprefix</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">gettempdir()</span></code> returns the default directory that will hold all
of the temporary files and <code class="docutils literal notranslate"><span class="pre">gettempprefix()</span></code> returns the string
prefix for new file and directory names.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 tempfile_settings.py

gettempdir(): /var/folders/5q/8gk0wq888xlggz008k8dr7180000hg/T
gettempprefix(): tmp
</pre></div>
</div>
<p>The value returned by <code class="docutils literal notranslate"><span class="pre">gettempdir()</span></code> is set based on a
straightforward algorithm of looking through a list of locations for
the first place the current process can create a file.  The search
list is:</p>
<ol class="arabic simple">
<li>The environment variable <code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code></li>
<li>The environment variable <code class="docutils literal notranslate"><span class="pre">TEMP</span></code></li>
<li>The environment variable <code class="docutils literal notranslate"><span class="pre">TMP</span></code></li>
<li>A fallback, based on the platform.  (Windows uses the first
available of <code class="docutils literal notranslate"><span class="pre">C:\temp</span></code>, <code class="docutils literal notranslate"><span class="pre">C:\tmp</span></code>, <code class="docutils literal notranslate"><span class="pre">\temp</span></code>, or <code class="docutils literal notranslate"><span class="pre">\tmp</span></code>.
Other platforms use <code class="docutils literal notranslate"><span class="pre">/tmp</span></code>, <code class="docutils literal notranslate"><span class="pre">/var/tmp</span></code>, or <code class="docutils literal notranslate"><span class="pre">/usr/tmp</span></code>.)</li>
<li>If no other directory can be found, the current working directory
is used.</li>
</ol>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">tempfile_tempdir.py</span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tempfile</span>

<span class="n">tempfile</span><span class="o">.</span><span class="n">tempdir</span> <span class="o">=</span> <span class="s1">&#39;/I/changed/this/path&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gettempdir():&#39;</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p>Programs that need to use a global location for all temporary files
without using any of these environment variables should set
<code class="docutils literal notranslate"><span class="pre">tempfile.tempdir</span></code> directly by assigning a value to the
variable.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 tempfile_tempdir.py

gettempdir(): /I/changed/this/path
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://docs.python.org/3.7/library/tempfile.html">Standard library documentation for tempfile</a></li>
<li><a class="reference internal" href="../random/index.html#module-random" title="random: Pseudorandom number generators"><code class="xref py py-mod docutils literal notranslate"><span class="pre">random</span></code></a> – Psuedorandom number generators, used to
introduce random values into temporary file names</li>
</ul>
</div>
</div>
</div>



        <div id="footer-nav">
<a id="prev-link" href="../linecache/index.html"
   title="previous chapter"><i class="fa fa-arrow-circle-left"></i> linecache — Read Text Files Efficiently</a>
<a id="next-link" href="../shutil/index.html"
   title="next chapter">shutil — High-level File Operations <i class="fa fa-arrow-circle-right"></i></a>
        </div>

        </div>
      </div>

      <div class="pure-u-1-4">
        <div class="sidebar-wrapper">
          <div class="sidebar">
<div id="sidebar-toc">
  <h5>Quick Links</h5>
  <ul>
    
    <li><a href="#temporary-files"><i class="fa fa-caret-right"></i>Temporary Files</a></li>
    
    <li><a href="#named-files"><i class="fa fa-caret-right"></i>Named Files</a></li>
    
    <li><a href="#spooled-files"><i class="fa fa-caret-right"></i>Spooled Files</a></li>
    
    <li><a href="#temporary-directories"><i class="fa fa-caret-right"></i>Temporary Directories</a></li>
    
    <li><a href="#predicting-names"><i class="fa fa-caret-right"></i>Predicting Names</a></li>
    
    <li><a href="#temporary-file-location"><i class="fa fa-caret-right"></i>Temporary File Location</a></li>
    
  </ul>
</div>

          </div>
          <div class="sidebar"><div id="sidebar-last-updated">
  This page was last updated 2016-12-28.
</div>

          </div>
          <div class="sidebar">
<div id="sidebar-nav">
  <h5>Navigation</h5>
  <ul>
    <li><a href="../linecache/index.html"
           title="previous chapter"><i class="fa fa-arrow-circle-left"></i>linecache — Read Text Files Efficiently</a></li>
    <li><a href="../shutil/index.html"
           title="next chapter"><i class="fa fa-arrow-circle-right"></i>shutil — High-level File Operations</a></li>
  </ul>
</div>
          </div>
          <div class="sidebar"><div id="sidebar-book"><a target="new" href="https://doughellmann.com/blog/the-python-3-standard-library-by-example/"><img src="../_static/book-cover-image-med.jpg"><br>Get the book</a></div>
          </div>
          <div class="sidebar"><div id="sidebar-example-disclaimer">
<p>The output from all the example programs
from PyMOTW-3 has been generated with Python 3.7.9, unless
otherwise noted. Some of the features described here may not be
available in earlier versions of Python.</p>
<p>Looking for <a href="/2/">examples for Python 2</a>?</p>
</div>
          </div>

        </div>
      </div>

    </div>

    <div class="pure-g-r" id="footer">

      <div class="pure-u-1-3">
        <div class="footer-list">
            <h4>This Site</h4>
            <ul>
              <li><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
              <li><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
            </ul>
        </div>
      </div><div class="pure-u-1-3">
          <div class="footer-content">
            <div class="socialmedia">
              <a class="sociallink" href="../index.html"
       title="Home">
      <i class="fa fa-home fa-lg"></i></a>
              <a class="sociallink" href="../about.html"
       title="About">
      <i class="fa fa-user fa-lg"></i></a>
              <a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a>
              <a class="sociallink" href="http://feeds.doughellmann.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a>
              <a class="sociallink" href="http://feedburner.google.com/fb/a/mailverify?uri=PyMOTW&amp;loc=en_US"
       title="Subscribe via Email">
      <i class="fa fa-envelope fa-lg"></i></a>
            </div>

            <div class="copyright">
              <a rel="author" href="../about.html">&copy; Copyright 2021, Doug Hellmann</a>
            </div>

            <div class="cc"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.en_US" rel="license"><img alt="Creative Commons License BY-NC-SA" style="border-width:0; align: center;" width="88" height="31" src="data:image/png;base64,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"/></a>
            </div>

          </div></div><div class="pure-u-1-3">
          <div class="footer-list">
            <h4>Other Writing</h4>
            <ul>
              <li><a href="https://doughellmann.com/"><i class="fa fa-pencil fa-lg"></i> Blog</a></li>
              <li><a href="https://doughellmann.com/blog/the-python-standard-library-by-example/"><i class="fa fa-book fa-lg"></i> The Python Standard Library By Example</a></li>
            </ul>
          </div>
        </div><script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38546875-3', 'pymotw.com');
  ga('send', 'pageview');
</script>

  </body>
</html>
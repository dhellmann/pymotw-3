<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>json — JavaScript Object Notation &mdash; PyMOTW 3</title>

    <link rel="stylesheet" href="../_static/pure-min.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pymotw.css" type="text/css">

    <link rel="shortcut icon" type="image/png" href="../_static/favicon.png">

    <link rel="alternate" type="application/atom+xml"
          title="Doug Hellmann"
          href="http://feeds.doughellmann.com/DougHellmann" />
    <link rel="alternate" type="application/atom+xml"
          title="PyMOTW Updates"
          href="http://feeds.doughellmann.com/PyMOTW" />

    <meta name="verify-v1" content="5saTcOa2HLac4V85yUg3SARfun1PqT5Upu7IR/6fpv4="/>

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@pymotw" />
    <meta name="twitter:title" content="Python 3 Module of the Week" />
    <meta name="twitter:description" content="json — JavaScript Object Notation" />
    <meta name="twitter:image" content="https://pymotw.com/3/_static/logo-large.png" />

  </head>
  <body>

    <div class="pure-menu pure-menu-open pure-menu-horizontal" id="site-menu">
      <a class="pure-menu-heading" href="../index.html"><img src="../_static/logo.png"> PyMOTW-3</a>

      <ul id="top-menu">
        <li class="pure-menu-selected"><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
        <li class="pure-menu-selected"><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
        <li class="pure-menu-selected"><a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a></a>
        <li class="pure-menu-selected"><a class="sociallink" href="http://feeds.doughellmann.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a></li>
      </ul>

    </div>

    <div class="pure-menu pure-menu-open pure-menu-vertical" id="breadcrumbs-menu">
      
      <ul id="breadcrumbs">
        <li class="pure-menu-selected"><a href="../internet_protocols.html"><i class="fa fa-arrow-circle-up"></i> The Internet</a></li>
      </ul>
    </div>

    <div class="pure-g-r" id="content-container">

      <div class="pure-u-3-4">
        <div class="content">
          
  <div class="section" id="module-json">
<span id="json-javascript-object-notation"></span><h1>json — JavaScript Object Notation<a class="headerlink" href="#module-json" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Encode Python objects as JSON strings, and decode JSON
strings into Python objects.</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">json</span></code> module provides an API similar to <a class="reference internal" href="../pickle/index.html#module-pickle" title="pickle: Object serialization"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a> for
converting in-memory Python objects to a serialized representation
known as JavaScript Object Notation (JSON).  Unlike pickle, JSON has
the benefit of having implementations in many languages (especially
JavaScript).  It is most widely used for communicating between the web
server and client in a REST API, but is also useful for other
inter-application communication needs.</p>
<div class="section" id="encoding-and-decoding-simple-data-types">
<h2>Encoding and Decoding Simple Data Types<a class="headerlink" href="#encoding-and-decoding-simple-data-types" title="Permalink to this headline">¶</a></h2>
<p>The encoder understands Python’s native types by default
(<code class="docutils literal notranslate"><span class="pre">str</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code>,
<code class="docutils literal notranslate"><span class="pre">tuple</span></code>, and <code class="docutils literal notranslate"><span class="pre">dict</span></code>).</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">json_simple_types.py</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">}]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DATA:&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="n">data_string</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;JSON:&#39;</span><span class="p">,</span> <span class="n">data_string</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Values are encoded in a manner superficially similar to Python’s
<code class="docutils literal notranslate"><span class="pre">repr()</span></code> output.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_simple_types.py

DATA: [{&#39;a&#39;: &#39;A&#39;, &#39;b&#39;: (2, 4), &#39;c&#39;: 3.0}]
JSON: [{&quot;a&quot;: &quot;A&quot;, &quot;b&quot;: [2, 4], &quot;c&quot;: 3.0}]
</pre></div>
</div>
<p>Encoding, then re-decoding may not give exactly the same type of
object.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">json_simple_types_decode.py</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">}]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DATA   :&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="n">data_string</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ENCODED:&#39;</span><span class="p">,</span> <span class="n">data_string</span><span class="p">)</span>

<span class="n">decoded</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data_string</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DECODED:&#39;</span><span class="p">,</span> <span class="n">decoded</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ORIGINAL:&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;b&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DECODED :&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">decoded</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;b&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<p>In particular, tuples become lists.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_simple_types_decode.py

DATA   : [{&#39;a&#39;: &#39;A&#39;, &#39;b&#39;: (2, 4), &#39;c&#39;: 3.0}]
ENCODED: [{&quot;a&quot;: &quot;A&quot;, &quot;b&quot;: [2, 4], &quot;c&quot;: 3.0}]
DECODED: [{&#39;a&#39;: &#39;A&#39;, &#39;b&#39;: [2, 4], &#39;c&#39;: 3.0}]
ORIGINAL: &lt;class &#39;tuple&#39;&gt;
DECODED : &lt;class &#39;list&#39;&gt;
</pre></div>
</div>
</div>
<div class="section" id="human-consumable-vs-compact-output">
<h2>Human-consumable vs. Compact Output<a class="headerlink" href="#human-consumable-vs-compact-output" title="Permalink to this headline">¶</a></h2>
<p>Another benefit of JSON over <a class="reference internal" href="../pickle/index.html#module-pickle" title="pickle: Object serialization"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a> is that the results are
human-readable.  The <code class="docutils literal notranslate"><span class="pre">dumps()</span></code> function accepts several arguments
to make the output even nicer.  For example, the <code class="docutils literal notranslate"><span class="pre">sort_keys</span></code> flag
tells the encoder to output the keys of a dictionary in sorted,
instead of random, order.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">json_sort_keys.py</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">}]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DATA:&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="n">unsorted</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;JSON:&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SORT:&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="n">first</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">second</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;UNSORTED MATCH:&#39;</span><span class="p">,</span> <span class="n">unsorted</span> <span class="o">==</span> <span class="n">first</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SORTED MATCH  :&#39;</span><span class="p">,</span> <span class="n">first</span> <span class="o">==</span> <span class="n">second</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Sorting makes it easier to scan the results by eye, and also makes it
possible to compare JSON output in tests.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_sort_keys.py

DATA: [{&#39;a&#39;: &#39;A&#39;, &#39;b&#39;: (2, 4), &#39;c&#39;: 3.0}]
JSON: [{&quot;a&quot;: &quot;A&quot;, &quot;b&quot;: [2, 4], &quot;c&quot;: 3.0}]
SORT: [{&quot;a&quot;: &quot;A&quot;, &quot;b&quot;: [2, 4], &quot;c&quot;: 3.0}]
UNSORTED MATCH: True
SORTED MATCH  : True
</pre></div>
</div>
<p>For highly-nested data structures, specify a value for <code class="docutils literal notranslate"><span class="pre">indent</span></code> so
the output is formatted nicely as well.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">json_indent.py</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">}]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DATA:&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;NORMAL:&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;INDENT:&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>When indent is a non-negative integer, the output more closely
resembles that of <a class="reference internal" href="../pprint/index.html#module-pprint" title="pprint: Pretty-print data structures"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pprint</span></code></a>, with leading spaces for each level of
the data structure matching the indent level.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_indent.py

DATA: [{&#39;a&#39;: &#39;A&#39;, &#39;b&#39;: (2, 4), &#39;c&#39;: 3.0}]
NORMAL: [{&quot;a&quot;: &quot;A&quot;, &quot;b&quot;: [2, 4], &quot;c&quot;: 3.0}]
INDENT: [
  {
    &quot;a&quot;: &quot;A&quot;,
    &quot;b&quot;: [
      2,
      4
    ],
    &quot;c&quot;: 3.0
  }
]
</pre></div>
</div>
<p>Verbose output like this increases the number of bytes needed to
transmit the same amount of data, however, so it is not intended for
use in a production environment.  In fact, it is possible to adjust
the settings for separating data in the encoded output to make it even
more compact than the default.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">json_compact_encoding.py</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">}]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DATA:&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;repr(data)             :&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>

<span class="n">plain_dump</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dumps(data)            :&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plain_dump</span><span class="p">))</span>

<span class="n">small_indent</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dumps(data, indent=2)  :&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">small_indent</span><span class="p">))</span>

<span class="n">with_separators</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dumps(data, separators):&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">with_separators</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">separators</span></code> argument to <code class="docutils literal notranslate"><span class="pre">dumps()</span></code> should be a tuple
containing the strings to separate items in a list and keys from
values in a dictionary.  The default is <code class="docutils literal notranslate"><span class="pre">(',</span> <span class="pre">',</span> <span class="pre">':</span> <span class="pre">')</span></code>. By removing
the whitespace, a more compact output is produced.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_compact_encoding.py

DATA: [{&#39;a&#39;: &#39;A&#39;, &#39;b&#39;: (2, 4), &#39;c&#39;: 3.0}]
repr(data)             : 35
dumps(data)            : 35
dumps(data, indent=2)  : 73
dumps(data, separators): 29
</pre></div>
</div>
</div>
<div class="section" id="encoding-dictionaries">
<h2>Encoding Dictionaries<a class="headerlink" href="#encoding-dictionaries" title="Permalink to this headline">¶</a></h2>
<p>The JSON format expects the keys to a dictionary to be strings.
Trying to encode a dictionary with non-string types as keys produces a
<code class="docutils literal notranslate"><span class="pre">TypeError</span></code>. One way to work around that limitation is to tell
the encoder to skip over non-string keys using the <code class="docutils literal notranslate"><span class="pre">skipkeys</span></code>
argument:</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">json_skipkeys.py</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,):</span> <span class="s1">&#39;D tuple&#39;</span><span class="p">}]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First attempt&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR:&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Second attempt&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">skipkeys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Rather than raising an exception, the non-string key is ignored.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_skipkeys.py

First attempt
ERROR: keys must be str, int, float, bool or None, not tuple

Second attempt
[{&quot;a&quot;: &quot;A&quot;, &quot;b&quot;: [2, 4], &quot;c&quot;: 3.0}]
</pre></div>
</div>
</div>
<div class="section" id="working-with-custom-types">
<h2>Working with Custom Types<a class="headerlink" href="#working-with-custom-types" title="Permalink to this headline">¶</a></h2>
<p>All of the examples so far have used Pythons built-in types because
those are supported by <code class="docutils literal notranslate"><span class="pre">json</span></code> natively.  It is common to need to
encode custom classes, as well, and there are two ways to do that.</p>
<p>Given this class to encode:</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">json_myobj.py</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span>
<span class="k">class</span> <span class="nc">MyObj</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;MyObj(</span><span class="si">{}</span><span class="s1">)&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The simple way of encoding a <code class="docutils literal notranslate"><span class="pre">MyObj</span></code> instance is to define a
function to convert an unknown type to a known type.  It does not need
to do the encoding, so it should just convert one object to another.</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">json_dump_default.py</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">json_myobj</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">json_myobj</span><span class="o">.</span><span class="n">MyObj</span><span class="p">(</span><span class="s1">&#39;instance value goes here&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First attempt&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR:&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">convert_to_builtin_type</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;default(&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
    <span class="c1"># Convert objects to a dictionary of their representation</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;__class__&#39;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
        <span class="s1">&#39;__module__&#39;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">d</span>


<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;With default&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">convert_to_builtin_type</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">convert_to_builtin_type()</span></code>, instances of classes not recognized
by <code class="docutils literal notranslate"><span class="pre">json</span></code> are converted to dictionaries with enough information
to re-create the object if a program has access to the Python modules
necessary.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_dump_default.py

First attempt
ERROR: Object of type MyObj is not JSON serializable

With default
default( &lt;MyObj(instance value goes here)&gt; )
{&quot;__class__&quot;: &quot;MyObj&quot;, &quot;__module__&quot;: &quot;json_myobj&quot;, &quot;s&quot;: &quot;instance
value goes here&quot;}
</pre></div>
</div>
<p>To decode the results and create a <code class="docutils literal notranslate"><span class="pre">MyObj()</span></code> instance, use the
<code class="docutils literal notranslate"><span class="pre">object_hook</span></code> argument to <code class="docutils literal notranslate"><span class="pre">loads()</span></code> to tie in to the decoder so
the class can be imported from the module and used to create the
instance.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">object_hook</span></code> is called for each dictionary decoded from the
incoming data stream, providing a chance to convert the dictionary to
another type of object.  The hook function should return the object
the calling application should receive instead of the dictionary.</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">json_load_object_hook.py</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>


<span class="k">def</span> <span class="nf">dict_to_object</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;__class__&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
        <span class="n">class_name</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;__class__&#39;</span><span class="p">)</span>
        <span class="n">module_name</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;__module__&#39;</span><span class="p">)</span>
        <span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MODULE:&#39;</span><span class="p">,</span> <span class="n">module</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="n">class_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CLASS:&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;INSTANCE ARGS:&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="n">inst</span> <span class="o">=</span> <span class="n">class_</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">inst</span> <span class="o">=</span> <span class="n">d</span>
    <span class="k">return</span> <span class="n">inst</span>


<span class="n">encoded_object</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    [{&quot;s&quot;: &quot;instance value goes here&quot;,</span>
<span class="s1">      &quot;__module__&quot;: &quot;json_myobj&quot;, &quot;__class__&quot;: &quot;MyObj&quot;}]</span>
<span class="s1">    &#39;&#39;&#39;</span>

<span class="n">myobj_instance</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
    <span class="n">encoded_object</span><span class="p">,</span>
    <span class="n">object_hook</span><span class="o">=</span><span class="n">dict_to_object</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myobj_instance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Since <code class="docutils literal notranslate"><span class="pre">json</span></code> converts string values to unicode objects, they need
to be re-encoded as ASCII strings before they can be used as keyword
arguments to the class constructor.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_load_object_hook.py

MODULE: json_myobj
CLASS: &lt;class &#39;json_myobj.MyObj&#39;&gt;
INSTANCE ARGS: {&#39;s&#39;: &#39;instance value goes here&#39;}
[&lt;MyObj(instance value goes here)&gt;]
</pre></div>
</div>
<p>Similar hooks are available for the built-in types integers
(<code class="docutils literal notranslate"><span class="pre">parse_int</span></code>), floating point numbers (<code class="docutils literal notranslate"><span class="pre">parse_float</span></code>), and
constants (<code class="docutils literal notranslate"><span class="pre">parse_constant</span></code>).</p>
</div>
<div class="section" id="encoder-and-decoder-classes">
<h2>Encoder and Decoder Classes<a class="headerlink" href="#encoder-and-decoder-classes" title="Permalink to this headline">¶</a></h2>
<p>Besides the convenience functions already covered, the <code class="docutils literal notranslate"><span class="pre">json</span></code>
module provides classes for encoding and decoding.  Using the classes
directly gives access to extra APIs for customizing their behavior.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">JSONEncoder</span></code> uses an iterable interface for producing
“chunks” of encoded data, making it easier to write to files or
network sockets without having to represent an entire data structure
in memory.</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">json_encoder_iterable.py</span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">}]</span>

<span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">encoder</span><span class="o">.</span><span class="n">iterencode</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PART:&#39;</span><span class="p">,</span> <span class="n">part</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The output is generated in logical units, rather than being based on
any size value.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_encoder_iterable.py

PART: [
PART: {
PART: &quot;a&quot;
PART: :
PART: &quot;A&quot;
PART: ,
PART: &quot;b&quot;
PART: :
PART: [2
PART: , 4
PART: ]
PART: ,
PART: &quot;c&quot;
PART: :
PART: 3.0
PART: }
PART: ]
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">encode()</span></code> method is basically equivalent to
<code class="docutils literal notranslate"><span class="pre">''.join(encoder.iterencode())</span></code>, with some extra error checking up
front.</p>
<p>To encode arbitrary objects, override the <code class="docutils literal notranslate"><span class="pre">default()</span></code> method with
an implementation similar to the one used in
<code class="docutils literal notranslate"><span class="pre">convert_to_builtin_type()</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">json_encoder_default.py</span><a class="headerlink" href="#id11" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">json_myobj</span>


<span class="k">class</span> <span class="nc">MyEncoder</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;default(&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
        <span class="c1"># Convert objects to a dictionary of their representation</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;__class__&#39;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="s1">&#39;__module__&#39;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span>


<span class="n">obj</span> <span class="o">=</span> <span class="n">json_myobj</span><span class="o">.</span><span class="n">MyObj</span><span class="p">(</span><span class="s1">&#39;internal data&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">MyEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The output is the same as the previous implementation.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_encoder_default.py

&lt;MyObj(internal data)&gt;
default( &lt;MyObj(internal data)&gt; )
{&quot;__class__&quot;: &quot;MyObj&quot;, &quot;__module__&quot;: &quot;json_myobj&quot;, &quot;s&quot;: &quot;internal
data&quot;}
</pre></div>
</div>
<p>Decoding text, then converting the dictionary into an object takes a
little more work to set up than the previous implementation, but not
much.</p>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">json_decoder_object_hook.py</span><a class="headerlink" href="#id12" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>


<span class="k">class</span> <span class="nc">MyDecoder</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">JSONDecoder</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">json</span><span class="o">.</span><span class="n">JSONDecoder</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">object_hook</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dict_to_object</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">dict_to_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;__class__&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">class_name</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;__class__&#39;</span><span class="p">)</span>
            <span class="n">module_name</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;__module__&#39;</span><span class="p">)</span>
            <span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MODULE:&#39;</span><span class="p">,</span> <span class="n">module</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="n">class_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CLASS:&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="p">)</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;INSTANCE ARGS:&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
            <span class="n">inst</span> <span class="o">=</span> <span class="n">class_</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inst</span> <span class="o">=</span> <span class="n">d</span>
        <span class="k">return</span> <span class="n">inst</span>


<span class="n">encoded_object</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">[{&quot;s&quot;: &quot;instance value goes here&quot;,</span>
<span class="s1">  &quot;__module__&quot;: &quot;json_myobj&quot;, &quot;__class__&quot;: &quot;MyObj&quot;}]</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">myobj_instance</span> <span class="o">=</span> <span class="n">MyDecoder</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encoded_object</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myobj_instance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>And the output is the same as the earlier example.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_decoder_object_hook.py

MODULE: json_myobj
CLASS: &lt;class &#39;json_myobj.MyObj&#39;&gt;
INSTANCE ARGS: {&#39;s&#39;: &#39;instance value goes here&#39;}
[&lt;MyObj(instance value goes here)&gt;]
</pre></div>
</div>
</div>
<div class="section" id="working-with-streams-and-files">
<h2>Working with Streams and Files<a class="headerlink" href="#working-with-streams-and-files" title="Permalink to this headline">¶</a></h2>
<p>All of the examples so far have assumed that the encoded version of
the entire data structure could be held in memory at one time.  With
large data structures, it may be preferable to write the encoding
directly to a file-like object.  The convenience functions
<code class="docutils literal notranslate"><span class="pre">load()</span></code> and <code class="docutils literal notranslate"><span class="pre">dump()</span></code> accept references to a file-like object
to use for reading or writing.</p>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">json_dump_file.py</span><a class="headerlink" href="#id13" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">}]</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
<span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p>A socket or normal file handle would work the same way as the
<code class="docutils literal notranslate"><span class="pre">StringIO</span></code> buffer used in this example.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_dump_file.py

[{&quot;a&quot;: &quot;A&quot;, &quot;b&quot;: [2, 4], &quot;c&quot;: 3.0}]
</pre></div>
</div>
<p>Although it is not optimized to read only part of the data at a time,
the <code class="docutils literal notranslate"><span class="pre">load()</span></code> function still offers the benefit of encapsulating
the logic of generating objects from stream input.</p>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text">json_load_file.py</span><a class="headerlink" href="#id14" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="s1">&#39;[{&quot;a&quot;: &quot;A&quot;, &quot;c&quot;: 3.0, &quot;b&quot;: [2, 4]}]&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Just as for <code class="docutils literal notranslate"><span class="pre">dump()</span></code>, any file-like object can be passed to
<code class="docutils literal notranslate"><span class="pre">load()</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_load_file.py

[{&#39;a&#39;: &#39;A&#39;, &#39;c&#39;: 3.0, &#39;b&#39;: [2, 4]}]
</pre></div>
</div>
</div>
<div class="section" id="mixed-data-streams">
<h2>Mixed Data Streams<a class="headerlink" href="#mixed-data-streams" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">JSONDecoder</span></code> includes <code class="docutils literal notranslate"><span class="pre">raw_decode()</span></code>, a method for
decoding a data structure followed by more data, such as JSON data
with trailing text.  The return value is the object created by
decoding the input data, and an index into that data indicating where
decoding left off.</p>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text">json_mixed_data.py</span><a class="headerlink" href="#id15" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="n">decoder</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecoder</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">get_decoded_and_remainder</span><span class="p">(</span><span class="n">input_data</span><span class="p">):</span>
    <span class="n">obj</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">decoder</span><span class="o">.</span><span class="n">raw_decode</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>
    <span class="n">remaining</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="n">end</span><span class="p">:]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">remaining</span><span class="p">)</span>


<span class="n">encoded_object</span> <span class="o">=</span> <span class="s1">&#39;[{&quot;a&quot;: &quot;A&quot;, &quot;c&quot;: 3.0, &quot;b&quot;: [2, 4]}]&#39;</span>
<span class="n">extra_text</span> <span class="o">=</span> <span class="s1">&#39;This text is not JSON.&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;JSON first:&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">encoded_object</span><span class="p">,</span> <span class="n">extra_text</span><span class="p">])</span>
<span class="n">obj</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">remaining</span> <span class="o">=</span> <span class="n">get_decoded_and_remainder</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Object              :&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;End of parsed input :&#39;</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Remaining text      :&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">remaining</span><span class="p">))</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;JSON embedded:&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">extra_text</span><span class="p">,</span> <span class="n">encoded_object</span><span class="p">,</span> <span class="n">extra_text</span><span class="p">])</span>
    <span class="n">obj</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">remaining</span> <span class="o">=</span> <span class="n">get_decoded_and_remainder</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR:&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Unfortunately, this only works if the object appears at the beginning
of the input.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 json_mixed_data.py

JSON first:
Object              : [{&#39;a&#39;: &#39;A&#39;, &#39;c&#39;: 3.0, &#39;b&#39;: [2, 4]}]
End of parsed input : 35
Remaining text      : &#39; This text is not JSON.&#39;

JSON embedded:
ERROR: Expecting value: line 1 column 1 (char 0)
</pre></div>
</div>
</div>
<div class="section" id="json-at-the-command-line">
<h2>JSON at the Command Line<a class="headerlink" href="#json-at-the-command-line" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">json.tool</span></code> module implements a command line program for
reformatting JSON data to be easier to read.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]}]</span>
</pre></div>
</div>
<p>The input file <code class="docutils literal notranslate"><span class="pre">example.json</span></code> contains a mapping with the keys out
of alphabetical order. The first example below shows the data
reformatted in order, and the second example uses <code class="docutils literal notranslate"><span class="pre">--sort-keys</span></code> to
sort the mapping keys before printing the output.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -m json.tool example.json

[
    {
        &quot;a&quot;: &quot;A&quot;,
        &quot;c&quot;: 3.0,
        &quot;b&quot;: [
            2,
            4
        ]
    }
]

$ python3 -m json.tool --sort-keys example.json

[
    {
        &quot;a&quot;: &quot;A&quot;,
        &quot;b&quot;: [
            2,
            4
        ],
        &quot;c&quot;: 3.0
    }
]
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://docs.python.org/3.7/library/json.html">Standard library documentation for json</a></li>
<li><a class="reference internal" href="../porting_notes.html#porting-json"><span class="std std-ref">Python 2 to 3 porting notes for json</span></a></li>
<li><a class="reference external" href="http://json.org/">JavaScript Object Notation</a> – JSON home, with documentation
and implementations in other languages.</li>
<li><a class="reference external" href="http://code.google.com/p/jsonpickle/">jsonpickle</a> –
<code class="docutils literal notranslate"><span class="pre">jsonpickle</span></code> allows for any Python object to be serialized into
JSON.</li>
</ul>
</div>
</div>
</div>



        <div id="footer-nav">
<a id="prev-link" href="../uuid/index.html"
   title="previous chapter"><i class="fa fa-arrow-circle-left"></i> uuid — Universally Unique Identifiers</a>
<a id="next-link" href="../xmlrpc.client/index.html"
   title="next chapter">xmlrpc.client — Client Library for XML-RPC <i class="fa fa-arrow-circle-right"></i></a>
        </div>

        </div>
      </div>

      <div class="pure-u-1-4">
        <div class="sidebar-wrapper">
          <div class="sidebar">
<div id="sidebar-toc">
  <h5>Quick Links</h5>
  <ul>
    
    <li><a href="#encoding-and-decoding-simple-data-types"><i class="fa fa-caret-right"></i>Encoding and Decoding Simple Data Types</a></li>
    
    <li><a href="#human-consumable-vs-compact-output"><i class="fa fa-caret-right"></i>Human-consumable vs. Compact Output</a></li>
    
    <li><a href="#encoding-dictionaries"><i class="fa fa-caret-right"></i>Encoding Dictionaries</a></li>
    
    <li><a href="#working-with-custom-types"><i class="fa fa-caret-right"></i>Working with Custom Types</a></li>
    
    <li><a href="#encoder-and-decoder-classes"><i class="fa fa-caret-right"></i>Encoder and Decoder Classes</a></li>
    
    <li><a href="#working-with-streams-and-files"><i class="fa fa-caret-right"></i>Working with Streams and Files</a></li>
    
    <li><a href="#mixed-data-streams"><i class="fa fa-caret-right"></i>Mixed Data Streams</a></li>
    
    <li><a href="#json-at-the-command-line"><i class="fa fa-caret-right"></i>JSON at the Command Line</a></li>
    
  </ul>
</div>

          </div>
          <div class="sidebar"><div id="sidebar-last-updated">
  This page was last updated 2018-12-09.
</div>

          </div>
          <div class="sidebar">
<div id="sidebar-nav">
  <h5>Navigation</h5>
  <ul>
    <li><a href="../uuid/index.html"
           title="previous chapter"><i class="fa fa-arrow-circle-left"></i>uuid — Universally Unique Identifiers</a></li>
    <li><a href="../xmlrpc.client/index.html"
           title="next chapter"><i class="fa fa-arrow-circle-right"></i>xmlrpc.client — Client Library for XML-RPC</a></li>
  </ul>
</div>
          </div>
          <div class="sidebar"><div id="sidebar-book"><a target="new" href="https://doughellmann.com/blog/the-python-3-standard-library-by-example/"><img src="../_static/book-cover-image-med.jpg"><br>Get the book</a></div>
          </div>
          <div class="sidebar"><div id="sidebar-example-disclaimer">
<p>The output from all the example programs
from PyMOTW-3 has been generated with Python 3.7.9, unless
otherwise noted. Some of the features described here may not be
available in earlier versions of Python.</p>
<p>Looking for <a href="/2/">examples for Python 2</a>?</p>
</div>
          </div>

        </div>
      </div>

    </div>

    <div class="pure-g-r" id="footer">

      <div class="pure-u-1-3">
        <div class="footer-list">
            <h4>This Site</h4>
            <ul>
              <li><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
              <li><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
            </ul>
        </div>
      </div><div class="pure-u-1-3">
          <div class="footer-content">
            <div class="socialmedia">
              <a class="sociallink" href="../index.html"
       title="Home">
      <i class="fa fa-home fa-lg"></i></a>
              <a class="sociallink" href="../about.html"
       title="About">
      <i class="fa fa-user fa-lg"></i></a>
              <a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a>
              <a class="sociallink" href="http://feeds.doughellmann.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a>
              <a class="sociallink" href="http://feedburner.google.com/fb/a/mailverify?uri=PyMOTW&amp;loc=en_US"
       title="Subscribe via Email">
      <i class="fa fa-envelope fa-lg"></i></a>
            </div>

            <div class="copyright">
              <a rel="author" href="../about.html">&copy; Copyright 2021, Doug Hellmann</a>
            </div>

            <div class="cc"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.en_US" rel="license"><img alt="Creative Commons License BY-NC-SA" style="border-width:0; align: center;" width="88" height="31" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAfCAMAAABUFvrSAAAABGdBTUEAALGOfPtRkwAAAf5QTFRF////////////AAAADQwNDQ4NDg4OEBAQGRkZGxsbHxscICAgIx8gJCQkKCUmKCgoKCkoKSkpKSopKicnKioqLS0tMDAwMS0uMjExMjMxNTY1Pj8+Pzc5Pzs8QEBAQ0RDUFBQUFFQWldYXV5dYGBgY19haGVmbmxscHBwcHJvdXJzdnN0eHV2eXx5en15fH98fX98fnt8f4F+gICAgoWChIGChIWEhIaEh4aHiYyJjIqLjoeLj4+PkY+PkZORkZSRk5iTlZmUlpmWmJaXmpiZnp2dnqCdn5aan5+fn6Oeoqaho6Gho6ijpqqmq7GqrKurrLKrrbOsrrOtrrStr6+vr7Kvr7Sur7WusLOvsLWvsLavsbewsrexsrixs7iytLmztLqztbW1tbq0tru1t7y2uL23ub64ub65urm5ur+5ur+6u8C6u8C7vMC8vMG7vMG8vcK8vcK9vsK9vsO+v7+/v8O+v8S+wMS/wMW/wMXAwcXAwsfCw8fCw8jDxMfDxMjDxMnExcnExcnFxsrFxsrGx8vHyMfHyMzHyMzIycjIyc3Iyc3Jys3Jy8rLy87Ky8/Ky8/LzM/LzNDLzNDMzdDMzdHMzdHNztHNztLOz8/Pz9PP0NPP0NTQ0dTQ0dTR0tXR0tXS09bS1tXV39/f4N/g4+Pj6Ofn7+/v8fHx////rrSdFQAAAAN0Uk5TAAoO5yEBUwAAA+FJREFUSMe1lo9301QUx6uXUmaf0qJ26iTrRoVinUzjQNR1gAyH6Lqx6XTDoVvXbU7qhA5m7CgYWaTDlLa6AiFsba3t+y+9Sdr8OvVMi7zTnLTf5H7ee9/73n11PA1PpDkcADPRWPwKt8YLG2I2n89m7gh8iluJz0dnpqe+HBsdHRn+7w3JyF1cvpbk05mCJG8Xi9uPpMLdNJ9cXV5UyBNjoyMtkR2A3B9Tt8SCfLTTqUzC2XlMvpcRbnA/IPmryYnzoyM9XuWBt8eI21FBcAy5Qk4KtxkGtQ1I+fRNbnk+evHC5NhJDwATDDIAnhNa1ImdFQTHr6WEvNyFPFeATSTYgAu/dl3/I31jNR6bnZ76eDf4yxRb2Q+71aiz/0JB8JXkrZzCdbFVqrUhRHuu54XkytLczAUvBFADUB6ARwnyqEp/t02prK9XdAXBHC9KyPWVqd6qPhyzlOG55dhsL/hLDTD1A3rYAy+dRu6eXaGKruA75wi2hbqigNd+LYSRW6XUSh64l05dXYruA1OPZfAOD3vhObL/ILDvQkRXynSdvPpaiJB+TVHAfEZuA9d9amlVF7TJd3nu+xgwyu8AqNOnDGAM8/obOLhQpWQotPYReZ/SQdKuKQpY2DwKwFJbGwI4VhCSlxchSFUnNC+CCgaV9RAKoZKh1J4le9FmQv5SFQW88aATXGhEws8wrHb7AANc0CndQS+ag5ERaieke0FXvnkxoYL/1MGi7FSmmVBXMDOu3gLK5J2PMjdXv2tmBX6pDdKSkq39DWXh3G1KI4QYVmS3AHCIPnCXE+4hHy6PcfeQ6sV2lufiL2jJ0wasp4p2k/Z2CEXeeqahDBLS1/c8+dBIXq4IkFAiWQ1QtxtnUMz/wsXfBj+1LzdUKn17dvXXzEqfMoFDNWO57QCe22dskKB5g7zXbVN+i0RKumKxonrfzaIVys2wYu7TVrd0PXn1rOnJC4JTFjF5c19/gnXLFwj6jJJz1rOjoi63LnBRfbmNM+qNunG5baSufhu9OPX5my2VTWEzrHrRbIP8dHl+dnpyrIVDBME/q1u6/E9bGmt9i2AsQmeaFaFwIb22soSlfuL8SEtgOCJKB5BsKkNltWyK7zzWMY3X4exDc6GvsljoX5FzR+BxwdCbf3jAdjTJv5/S39H2B2iXpmgXpWB7iVrB0JuVzpgP07CUO2WKqX+oiVL/benKImhgOIzHf7hx/A/IBdHsQ6Nsmruilo4afVFqB8PLn2U2H8hbxeKWjH9YvuiwxNiMaNhALZptCg5d7zh+Sczmclnx0vEOax6ajdjucSMPTcD/97/Cp54Q929ZZbgcR3o0hAAAAABJRU5ErkJggg=="/></a>
            </div>

          </div></div><div class="pure-u-1-3">
          <div class="footer-list">
            <h4>Other Writing</h4>
            <ul>
              <li><a href="https://doughellmann.com/"><i class="fa fa-pencil fa-lg"></i> Blog</a></li>
              <li><a href="https://doughellmann.com/blog/the-python-standard-library-by-example/"><i class="fa fa-book fa-lg"></i> The Python Standard Library By Example</a></li>
            </ul>
          </div>
        </div><script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38546875-3', 'pymotw.com');
  ga('send', 'pageview');
</script>

  </body>
</html>
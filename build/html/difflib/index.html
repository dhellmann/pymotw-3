<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>difflib — Compare Sequences &mdash; PyMOTW 3</title>

    <link rel="stylesheet" href="../_static/pure-min.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pymotw.css" type="text/css">

    <link rel="shortcut icon" type="image/png" href="../_static/favicon.png">

    <link rel="alternate" type="application/atom+xml"
          title="Doug Hellmann"
          href="http://feeds.doughellmann.com/DougHellmann" />
    <link rel="alternate" type="application/atom+xml"
          title="PyMOTW Updates"
          href="http://feeds.doughellmann.com/PyMOTW" />

    <meta name="verify-v1" content="5saTcOa2HLac4V85yUg3SARfun1PqT5Upu7IR/6fpv4="/>

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@pymotw" />
    <meta name="twitter:title" content="Python 3 Module of the Week" />
    <meta name="twitter:description" content="difflib — Compare Sequences" />
    <meta name="twitter:image" content="https://pymotw.com/3/_static/logo-large.png" />

  </head>
  <body>

    <div class="pure-menu pure-menu-open pure-menu-horizontal" id="site-menu">
      <a class="pure-menu-heading" href="../index.html"><img src="../_static/logo.png"> PyMOTW-3</a>

      <ul id="top-menu">
        <li class="pure-menu-selected"><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
        <li class="pure-menu-selected"><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
        <li class="pure-menu-selected"><a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a></a>
        <li class="pure-menu-selected"><a class="sociallink" href="http://feeds.doughellmann.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a></li>
      </ul>

    </div>

    <div class="pure-menu pure-menu-open pure-menu-vertical" id="breadcrumbs-menu">
      
      <ul id="breadcrumbs">
        <li class="pure-menu-selected"><a href="../text.html"><i class="fa fa-arrow-circle-up"></i> Text</a></li>
      </ul>
    </div>

    <div class="pure-g-r" id="content-container">

      <div class="pure-u-3-4">
        <div class="content">
          
  <div class="section" id="module-difflib">
<span id="difflib-compare-sequences"></span><h1>difflib — Compare Sequences<a class="headerlink" href="#module-difflib" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Compare sequences, especially lines of text.</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">difflib</span></code> module contains tools for computing and working
with differences between sequences.  It is especially useful for
comparing text, and includes functions that produce reports using
several common difference formats.</p>
<p>The examples in this section will all use this common test data in the
<code class="docutils literal notranslate"><span class="pre">difflib_data.py</span></code> module:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">difflib_data.py</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">text1</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Lorem ipsum dolor sit amet, consectetuer adipiscing</span>
<span class="s2">elit. Integer eu lacus accumsan arcu fermentum euismod. Donec</span>
<span class="s2">pulvinar porttitor tellus. Aliquam venenatis. Donec facilisis</span>
<span class="s2">pharetra tortor.  In nec mauris eget magna consequat</span>
<span class="s2">convalis. Nam sed sem vitae odio pellentesque interdum. Sed</span>
<span class="s2">consequat viverra nisl. Suspendisse arcu metus, blandit quis,</span>
<span class="s2">rhoncus ac, pharetra eget, velit. Mauris urna. Morbi nonummy</span>
<span class="s2">molestie orci. Praesent nisi elit, fringilla ac, suscipit non,</span>
<span class="s2">tristique vel, mauris. Curabitur vel lorem id nisl porta</span>
<span class="s2">adipiscing. Suspendisse eu lectus. In nunc. Duis vulputate</span>
<span class="s2">tristique enim. Donec quis lectus a justo imperdiet tempus.&quot;&quot;&quot;</span>

<span class="n">text1_lines</span> <span class="o">=</span> <span class="n">text1</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>

<span class="n">text2</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Lorem ipsum dolor sit amet, consectetuer adipiscing</span>
<span class="s2">elit. Integer eu lacus accumsan arcu fermentum euismod. Donec</span>
<span class="s2">pulvinar, porttitor tellus. Aliquam venenatis. Donec facilisis</span>
<span class="s2">pharetra tortor. In nec mauris eget magna consequat</span>
<span class="s2">convalis. Nam cras vitae mi vitae odio pellentesque interdum. Sed</span>
<span class="s2">consequat viverra nisl. Suspendisse arcu metus, blandit quis,</span>
<span class="s2">rhoncus ac, pharetra eget, velit. Mauris urna. Morbi nonummy</span>
<span class="s2">molestie orci. Praesent nisi elit, fringilla ac, suscipit non,</span>
<span class="s2">tristique vel, mauris. Curabitur vel lorem id nisl porta</span>
<span class="s2">adipiscing. Duis vulputate tristique enim. Donec quis lectus a</span>
<span class="s2">justo imperdiet tempus.  Suspendisse eu lectus. In nunc.&quot;&quot;&quot;</span>

<span class="n">text2_lines</span> <span class="o">=</span> <span class="n">text2</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="comparing-bodies-of-text">
<h2>Comparing Bodies of Text<a class="headerlink" href="#comparing-bodies-of-text" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Differ</span></code> class works on sequences of text lines and
produces human-readable <em>deltas</em>, or change instructions, including
differences within individual lines.  The default output produced by
<code class="docutils literal notranslate"><span class="pre">Differ</span></code> is similar to the <code class="docutils literal notranslate"><span class="pre">diff</span></code> command-line tool
under Unix.  It includes the original input values from both lists,
including common values, and markup data to indicate which changes were
made.</p>
<ul class="simple">
<li>Lines prefixed with <code class="docutils literal notranslate"><span class="pre">-</span></code> were in the first sequence, but not the
second.</li>
<li>Lines prefixed with <code class="docutils literal notranslate"><span class="pre">+</span></code> were in the second sequence, but not the
first.</li>
<li>If a line has an incremental difference between versions, an extra
line prefixed with <code class="docutils literal notranslate"><span class="pre">?</span></code> is used to highlight the change within the
new version.</li>
<li>If a line has not changed, it is printed with an extra blank space
on the left column so that it is aligned with the other output that
may have differences.</li>
</ul>
<p>Breaking the text up into a sequence of individual lines before
passing it to <code class="docutils literal notranslate"><span class="pre">compare()</span></code> produces more readable output than
passing in large strings.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">difflib_differ.py</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">difflib</span>
<span class="kn">from</span> <span class="nn">difflib_data</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">difflib</span><span class="o">.</span><span class="n">Differ</span><span class="p">()</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">text1_lines</span><span class="p">,</span> <span class="n">text2_lines</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">diff</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The beginning of both text segments in the sample data is the same, so
the first line is printed without any extra annotation.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span>  <span class="n">Lorem</span> <span class="n">ipsum</span> <span class="n">dolor</span> <span class="n">sit</span> <span class="n">amet</span><span class="p">,</span> <span class="n">consectetuer</span> <span class="n">adipiscing</span>
  <span class="n">elit</span><span class="o">.</span> <span class="n">Integer</span> <span class="n">eu</span> <span class="n">lacus</span> <span class="n">accumsan</span> <span class="n">arcu</span> <span class="n">fermentum</span> <span class="n">euismod</span><span class="o">.</span> <span class="n">Donec</span>
</pre></div>
</div>
<p>The third line of the data has been changed to include a comma in the
modified text. Both versions of the line are printed, with the extra
information on line 5 showing the column where the text was modified,
including the fact that the <code class="docutils literal notranslate"><span class="pre">,</span></code> character was added.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- pulvinar porttitor tellus. Aliquam venenatis. Donec facilisis
+ pulvinar, porttitor tellus. Aliquam venenatis. Donec facilisis
?         +
</pre></div>
</div>
<p>The next few lines of the output show that an extra space was removed.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- pharetra tortor.  In nec mauris eget magna consequat
?                 -

+ pharetra tortor. In nec mauris eget magna consequat
</pre></div>
</div>
<p>Next, a more complex change was made, replacing several words in a phrase.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- convalis. Nam sed sem vitae odio pellentesque interdum. Sed
?                 - --

+ convalis. Nam cras vitae mi vitae odio pellentesque interdum. Sed
?               +++ +++++   +

</pre></div>
</div>
<p>The last sentence in the paragraph was changed significantly, so the
difference is represented by removing the old version and adding the
new.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  consequat viverra nisl. Suspendisse arcu metus, blandit quis,
  rhoncus ac, pharetra eget, velit. Mauris urna. Morbi nonummy
  molestie orci. Praesent nisi elit, fringilla ac, suscipit non,
  tristique vel, mauris. Curabitur vel lorem id nisl porta
- adipiscing. Suspendisse eu lectus. In nunc. Duis vulputate
- tristique enim. Donec quis lectus a justo imperdiet tempus.
+ adipiscing. Duis vulputate tristique enim. Donec quis lectus a
+ justo imperdiet tempus.  Suspendisse eu lectus. In nunc.
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ndiff()</span></code> function produces essentially the same output.
The processing is specifically tailored for working with text data and
eliminating “noise” in the input.</p>
<div class="section" id="other-output-formats">
<h3>Other Output Formats<a class="headerlink" href="#other-output-formats" title="Permalink to this headline">¶</a></h3>
<p>While the <code class="docutils literal notranslate"><span class="pre">Differ</span></code> class shows all of the input lines, a
<em>unified diff</em> includes only the modified lines and a bit of context. The
<code class="docutils literal notranslate"><span class="pre">unified_diff()</span></code> function produces this sort of output.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">difflib_unified.py</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">difflib</span>
<span class="kn">from</span> <span class="nn">difflib_data</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">diff</span> <span class="o">=</span> <span class="n">difflib</span><span class="o">.</span><span class="n">unified_diff</span><span class="p">(</span>
    <span class="n">text1_lines</span><span class="p">,</span>
    <span class="n">text2_lines</span><span class="p">,</span>
    <span class="n">lineterm</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">diff</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">lineterm</span></code> argument is used to tell <code class="docutils literal notranslate"><span class="pre">unified_diff()</span></code> to skip
appending newlines to the control lines that it returns because the input
lines do not include them.  Newlines are added to all of the lines
when they are printed.  The output should look familiar to users of
many popular version-control tools.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 difflib_unified.py

---
+++
@@ -1,11 +1,11 @@
 Lorem ipsum dolor sit amet, consectetuer adipiscing
 elit. Integer eu lacus accumsan arcu fermentum euismod. Donec
-pulvinar porttitor tellus. Aliquam venenatis. Donec facilisis
-pharetra tortor.  In nec mauris eget magna consequat
-convalis. Nam sed sem vitae odio pellentesque interdum. Sed
+pulvinar, porttitor tellus. Aliquam venenatis. Donec facilisis
+pharetra tortor. In nec mauris eget magna consequat
+convalis. Nam cras vitae mi vitae odio pellentesque interdum. S
ed
 consequat viverra nisl. Suspendisse arcu metus, blandit quis,
 rhoncus ac, pharetra eget, velit. Mauris urna. Morbi nonummy
 molestie orci. Praesent nisi elit, fringilla ac, suscipit non,
 tristique vel, mauris. Curabitur vel lorem id nisl porta
-adipiscing. Suspendisse eu lectus. In nunc. Duis vulputate
-tristique enim. Donec quis lectus a justo imperdiet tempus.
+adipiscing. Duis vulputate tristique enim. Donec quis lectus a
+justo imperdiet tempus.  Suspendisse eu lectus. In nunc.
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">context_diff()</span></code> produces similar readable output.</p>
</div>
</div>
<div class="section" id="junk-data">
<h2>Junk Data<a class="headerlink" href="#junk-data" title="Permalink to this headline">¶</a></h2>
<p>All of the functions that produce difference sequences accept
arguments to indicate which lines should be ignored and which
characters within a line should be ignored. These parameters can be
used to skip over markup or whitespace changes in two versions of a
file, for example.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">difflib_junk.py</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This example is adapted from the source for difflib.py.</span>

<span class="kn">from</span> <span class="nn">difflib</span> <span class="k">import</span> <span class="n">SequenceMatcher</span>


<span class="k">def</span> <span class="nf">show_results</span><span class="p">(</span><span class="n">match</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  a    = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">a</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  b    = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">b</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  size = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">match</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  A[a:a+size] = </span><span class="si">{!r}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  B[b:b+size] = </span><span class="si">{!r}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span> <span class="o">+</span> <span class="n">k</span><span class="p">]))</span>


<span class="n">A</span> <span class="o">=</span> <span class="s2">&quot; abcd&quot;</span>
<span class="n">B</span> <span class="o">=</span> <span class="s2">&quot;abcd abcd&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A = </span><span class="si">{!r}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;B = </span><span class="si">{!r}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Without junk detection:&#39;</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">SequenceMatcher</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="n">match1</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">find_longest_match</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
<span class="n">show_results</span><span class="p">(</span><span class="n">match1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Treat spaces as junk:&#39;</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">SequenceMatcher</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="n">match2</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">find_longest_match</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
<span class="n">show_results</span><span class="p">(</span><span class="n">match2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The default for <code class="docutils literal notranslate"><span class="pre">Differ</span></code> is to not ignore any lines or
characters explicitly, but rather to rely on the ability of
<code class="docutils literal notranslate"><span class="pre">SequenceMatcher</span></code> to detect noise. The default for
<code class="docutils literal notranslate"><span class="pre">ndiff()</span></code> is to ignore space and tab characters.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 difflib_junk.py

A = &#39; abcd&#39;
B = &#39;abcd abcd&#39;

Without junk detection:
  a    = 0
  b    = 4
  size = 5
  A[a:a+size] = &#39; abcd&#39;
  B[b:b+size] = &#39; abcd&#39;

Treat spaces as junk:
  a    = 1
  b    = 0
  size = 4
  A[a:a+size] = &#39;abcd&#39;
  B[b:b+size] = &#39;abcd&#39;
</pre></div>
</div>
</div>
<div class="section" id="comparing-arbitrary-types">
<h2>Comparing Arbitrary Types<a class="headerlink" href="#comparing-arbitrary-types" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">SequenceMatcher</span></code> class compares two sequences of any
types, as long as the values are hashable. It uses an algorithm to
identify the longest contiguous matching blocks from the sequences,
eliminating “junk” values that do not contribute to the real data.</p>
<p>The funct <code class="docutils literal notranslate"><span class="pre">get_opcodes()</span></code> returns a list of instructions for
modifying the first sequence to make it match the second. The
instructions are encoded as five-element tuples, including a string
instruction (the “opcode”, see the table below) and two pairs of start and stop indexes into the
sequences (denoted as <code class="docutils literal notranslate"><span class="pre">i1</span></code>, <code class="docutils literal notranslate"><span class="pre">i2</span></code>, <code class="docutils literal notranslate"><span class="pre">j1</span></code>, and <code class="docutils literal notranslate"><span class="pre">j2</span></code>).</p>
<table border="1" class="docutils" id="id5">
<caption><span class="caption-text">difflib.get_opcodes() Instructions</span><a class="headerlink" href="#id5" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Opcode</th>
<th class="head">Definition</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">'replace'</span></code></td>
<td>Replace <code class="docutils literal notranslate"><span class="pre">a[i1:i2]</span></code> with <code class="docutils literal notranslate"><span class="pre">b[j1:j2]</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">'delete'</span></code></td>
<td>Remove <code class="docutils literal notranslate"><span class="pre">a[i1:i2]</span></code> entirely</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">'insert'</span></code></td>
<td>Insert <code class="docutils literal notranslate"><span class="pre">b[j1:j2]</span></code> at <code class="docutils literal notranslate"><span class="pre">a[i1:i1]</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">'equal'</span></code></td>
<td>The subsequences are already equal</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">difflib_seq.py</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">difflib</span>

<span class="n">s1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">s2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Initial data:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;s1 =&#39;</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;s2 =&#39;</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;s1 == s2:&#39;</span><span class="p">,</span> <span class="n">s1</span> <span class="o">==</span> <span class="n">s2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">matcher</span> <span class="o">=</span> <span class="n">difflib</span><span class="o">.</span><span class="n">SequenceMatcher</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">tag</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">j1</span><span class="p">,</span> <span class="n">j2</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">matcher</span><span class="o">.</span><span class="n">get_opcodes</span><span class="p">()):</span>

    <span class="k">if</span> <span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;delete&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Remove </span><span class="si">{}</span><span class="s1"> from positions [</span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">s1</span><span class="p">[</span><span class="n">i1</span><span class="p">:</span><span class="n">i2</span><span class="p">],</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  before =&#39;</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">s1</span><span class="p">[</span><span class="n">i1</span><span class="p">:</span><span class="n">i2</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;equal&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;s1[</span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1">] and s2[</span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1">] are the same&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">j1</span><span class="p">,</span> <span class="n">j2</span><span class="p">))</span>

    <span class="k">elif</span> <span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;insert&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Insert </span><span class="si">{}</span><span class="s1"> from s2[</span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1">] into s1 at </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">s2</span><span class="p">[</span><span class="n">j1</span><span class="p">:</span><span class="n">j2</span><span class="p">],</span> <span class="n">j1</span><span class="p">,</span> <span class="n">j2</span><span class="p">,</span> <span class="n">i1</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  before =&#39;</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span>
        <span class="n">s1</span><span class="p">[</span><span class="n">i1</span><span class="p">:</span><span class="n">i2</span><span class="p">]</span> <span class="o">=</span> <span class="n">s2</span><span class="p">[</span><span class="n">j1</span><span class="p">:</span><span class="n">j2</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;replace&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">((</span><span class="s1">&#39;Replace </span><span class="si">{}</span><span class="s1"> from s1[</span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1">] &#39;</span>
               <span class="s1">&#39;with </span><span class="si">{}</span><span class="s1"> from s2[</span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                   <span class="n">s1</span><span class="p">[</span><span class="n">i1</span><span class="p">:</span><span class="n">i2</span><span class="p">],</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">s2</span><span class="p">[</span><span class="n">j1</span><span class="p">:</span><span class="n">j2</span><span class="p">],</span> <span class="n">j1</span><span class="p">,</span> <span class="n">j2</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  before =&#39;</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span>
        <span class="n">s1</span><span class="p">[</span><span class="n">i1</span><span class="p">:</span><span class="n">i2</span><span class="p">]</span> <span class="o">=</span> <span class="n">s2</span><span class="p">[</span><span class="n">j1</span><span class="p">:</span><span class="n">j2</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   after =&#39;</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;s1 == s2:&#39;</span><span class="p">,</span> <span class="n">s1</span> <span class="o">==</span> <span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This example compares two lists of integers and uses
<code class="docutils literal notranslate"><span class="pre">get_opcodes()</span></code> to derive the instructions for converting the
original list into the newer version.  The modifications are applied
in reverse order so that the list indexes remain accurate after items
are added and removed.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 difflib_seq.py

Initial data:
s1 = [1, 2, 3, 5, 6, 4]
s2 = [2, 3, 5, 4, 6, 1]
s1 == s2: False

Replace [4] from s1[5:6] with [1] from s2[5:6]
  before = [1, 2, 3, 5, 6, 4]
   after = [1, 2, 3, 5, 6, 1]

s1[4:5] and s2[4:5] are the same
   after = [1, 2, 3, 5, 6, 1]

Insert [4] from s2[3:4] into s1 at 4
  before = [1, 2, 3, 5, 6, 1]
   after = [1, 2, 3, 5, 4, 6, 1]

s1[1:4] and s2[0:3] are the same
   after = [1, 2, 3, 5, 4, 6, 1]

Remove [1] from positions [0:1]
  before = [1, 2, 3, 5, 4, 6, 1]
   after = [2, 3, 5, 4, 6, 1]

s1 == s2: True
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SequenceMatcher</span></code> works with custom classes, as well as
built-in types, as long as they are hashable.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://docs.python.org/3.7/library/difflib.html">Standard library documentation for difflib</a></li>
<li><a class="reference external" href="http://www.drdobbs.com/database/pattern-matching-the-gestalt-approach/184407970">“Pattern Matching: The Gestalt Approach”</a>
– Discussion of a similar algorithm by John W. Ratcliff
and D. E. Metzener published in <em>Dr. Dobb’s Journal</em> in July, 1988.</li>
</ul>
</div>
</div>
</div>



        <div id="footer-nav">
<a id="prev-link" href="../re/index.html"
   title="previous chapter"><i class="fa fa-arrow-circle-left"></i> re — Regular Expressions</a>
<a id="next-link" href="../data_structures.html"
   title="next chapter">Data Structures <i class="fa fa-arrow-circle-right"></i></a>
        </div>

        </div>
      </div>

      <div class="pure-u-1-4">
        <div class="sidebar-wrapper">
          <div class="sidebar">
<div id="sidebar-toc">
  <h5>Quick Links</h5>
  <ul>
    
    <li><a href="#comparing-bodies-of-text"><i class="fa fa-caret-right"></i>Comparing Bodies of Text</a></li>
    
    <li><a href="#other-output-formats"><i class="fa fa-caret-right"></i>Other Output Formats</a></li>
    
    <li><a href="#junk-data"><i class="fa fa-caret-right"></i>Junk Data</a></li>
    
    <li><a href="#comparing-arbitrary-types"><i class="fa fa-caret-right"></i>Comparing Arbitrary Types</a></li>
    
  </ul>
</div>

          </div>
          <div class="sidebar"><div id="sidebar-last-updated">
  This page was last updated 2017-01-28.
</div>

          </div>
          <div class="sidebar">
<div id="sidebar-nav">
  <h5>Navigation</h5>
  <ul>
    <li><a href="../re/index.html"
           title="previous chapter"><i class="fa fa-arrow-circle-left"></i>re — Regular Expressions</a></li>
    <li><a href="../data_structures.html"
           title="next chapter"><i class="fa fa-arrow-circle-right"></i>Data Structures</a></li>
  </ul>
</div>
          </div>
          <div class="sidebar"><div id="sidebar-book"><a target="new" href="https://doughellmann.com/blog/the-python-3-standard-library-by-example/"><img src="../_static/book-cover-image-med.jpg"><br>Get the book</a></div>
          </div>
          <div class="sidebar"><div id="sidebar-example-disclaimer">
<p>The output from all the example programs
from PyMOTW-3 has been generated with Python 3.7.9, unless
otherwise noted. Some of the features described here may not be
available in earlier versions of Python.</p>
<p>Looking for <a href="/2/">examples for Python 2</a>?</p>
</div>
          </div>

        </div>
      </div>

    </div>

    <div class="pure-g-r" id="footer">

      <div class="pure-u-1-3">
        <div class="footer-list">
            <h4>This Site</h4>
            <ul>
              <li><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
              <li><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
            </ul>
        </div>
      </div><div class="pure-u-1-3">
          <div class="footer-content">
            <div class="socialmedia">
              <a class="sociallink" href="../index.html"
       title="Home">
      <i class="fa fa-home fa-lg"></i></a>
              <a class="sociallink" href="../about.html"
       title="About">
      <i class="fa fa-user fa-lg"></i></a>
              <a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a>
              <a class="sociallink" href="http://feeds.doughellmann.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a>
              <a class="sociallink" href="http://feedburner.google.com/fb/a/mailverify?uri=PyMOTW&amp;loc=en_US"
       title="Subscribe via Email">
      <i class="fa fa-envelope fa-lg"></i></a>
            </div>

            <div class="copyright">
              <a rel="author" href="../about.html">&copy; Copyright 2021, Doug Hellmann</a>
            </div>

            <div class="cc"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.en_US" rel="license"><img alt="Creative Commons License BY-NC-SA" style="border-width:0; align: center;" width="88" height="31" src="data:image/png;base64,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"/></a>
            </div>

          </div></div><div class="pure-u-1-3">
          <div class="footer-list">
            <h4>Other Writing</h4>
            <ul>
              <li><a href="https://doughellmann.com/"><i class="fa fa-pencil fa-lg"></i> Blog</a></li>
              <li><a href="https://doughellmann.com/blog/the-python-standard-library-by-example/"><i class="fa fa-book fa-lg"></i> The Python Standard Library By Example</a></li>
            </ul>
          </div>
        </div><script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38546875-3', 'pymotw.com');
  ga('send', 'pageview');
</script>

  </body>
</html>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>os — Portable access to operating system specific features &mdash; PyMOTW 3</title>

    <link rel="stylesheet" href="../_static/pure-min.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pymotw.css" type="text/css">

    <link rel="shortcut icon" type="image/png" href="../_static/favicon.png">

    <link rel="alternate" type="application/atom+xml"
          title="Doug Hellmann"
          href="http://feeds.doughellmann.com/DougHellmann" />
    <link rel="alternate" type="application/atom+xml"
          title="PyMOTW Updates"
          href="http://feeds.doughellmann.com/PyMOTW" />

    <meta name="verify-v1" content="5saTcOa2HLac4V85yUg3SARfun1PqT5Upu7IR/6fpv4="/>

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@pymotw" />
    <meta name="twitter:title" content="Python 3 Module of the Week" />
    <meta name="twitter:description" content="os — Portable access to operating system specific features" />
    <meta name="twitter:image" content="https://pymotw.com/3/_static/logo-large.png" />

  </head>
  <body>

    <div class="pure-menu pure-menu-open pure-menu-horizontal" id="site-menu">
      <a class="pure-menu-heading" href="../index.html"><img src="../_static/logo.png"> PyMOTW-3</a>

      <ul id="top-menu">
        <li class="pure-menu-selected"><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
        <li class="pure-menu-selected"><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
        <li class="pure-menu-selected"><a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a></a>
        <li class="pure-menu-selected"><a class="sociallink" href="http://feeds.doughellmann.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a></li>
      </ul>

    </div>

    <div class="pure-menu pure-menu-open pure-menu-vertical" id="breadcrumbs-menu">
      
      <ul id="breadcrumbs">
        <li class="pure-menu-selected"><a href="../runtime_services.html"><i class="fa fa-arrow-circle-up"></i> Runtime Features</a></li>
      </ul>
    </div>

    <div class="pure-g-r" id="content-container">

      <div class="pure-u-3-4">
        <div class="content">
          
  <div class="section" id="module-os">
<span id="os-portable-access-to-operating-system-specific-features"></span><h1>os — Portable access to operating system specific features<a class="headerlink" href="#module-os" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Portable access to operating system specific features.</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">os</span></code> module provides a wrapper for platform specific modules
such as <code class="xref py py-mod docutils literal notranslate"><span class="pre">posix</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">nt</span></code>, and <code class="xref py py-mod docutils literal notranslate"><span class="pre">mac</span></code>. The API for functions
available on all platforms should be the same, so using the <code class="docutils literal notranslate"><span class="pre">os</span></code>
module offers some measure of portability. Not all functions are
available on every platform, however. Many of the process management
functions described in this summary are not available for Windows.</p>
<p>The Python documentation for the <code class="docutils literal notranslate"><span class="pre">os</span></code> module is subtitled
“Miscellaneous operating system interfaces”. The module consists
mostly of functions for creating and managing running processes or
file system content (files and directories), with a few other bits of
functionality thrown in besides.</p>
<div class="section" id="examining-the-file-system-contents">
<h2>Examining the File System Contents<a class="headerlink" href="#examining-the-file-system-contents" title="Permalink to this headline">¶</a></h2>
<p>To prepare a list of the contents of a directory on the file system,
use <code class="docutils literal notranslate"><span class="pre">listdir()</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">os_listdir.py</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<p>The return value is an unsorted list of all of the named members of the
directory given. No distinction is made between files, subdirectories,
or symlinks.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_listdir.py .

[&#39;index.rst&#39;, &#39;os_access.py&#39;, &#39;os_cwd_example.py&#39;,
&#39;os_directories.py&#39;, &#39;os_environ_example.py&#39;,
&#39;os_exec_example.py&#39;, &#39;os_fork_example.py&#39;,
&#39;os_kill_example.py&#39;, &#39;os_listdir.py&#39;, &#39;os_listdir.py~&#39;,
&#39;os_process_id_example.py&#39;, &#39;os_process_user_example.py&#39;,
&#39;os_rename_replace.py&#39;, &#39;os_rename_replace.py~&#39;,
&#39;os_scandir.py&#39;, &#39;os_scandir.py~&#39;, &#39;os_spawn_example.py&#39;,
&#39;os_stat.py&#39;, &#39;os_stat_chmod.py&#39;, &#39;os_stat_chmod_example.txt&#39;,
&#39;os_strerror.py&#39;, &#39;os_strerror.py~&#39;, &#39;os_symlinks.py&#39;,
&#39;os_system_background.py&#39;, &#39;os_system_example.py&#39;,
&#39;os_system_shell.py&#39;, &#39;os_wait_example.py&#39;,
&#39;os_waitpid_example.py&#39;, &#39;os_walk.py&#39;]
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">walk()</span></code> traverses a directory recursively and for
each subdirectory generates a <code class="docutils literal notranslate"><span class="pre">tuple</span></code> containing the directory
path, any immediate sub-directories of that path, and a list of the
names of any files in that directory.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">os_walk.py</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># If we are not given a path to list, use /tmp</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">root</span> <span class="o">=</span> <span class="s1">&#39;/tmp&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">dir_name</span><span class="p">,</span> <span class="n">sub_dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span>
    <span class="c1"># Make the subdirectory names stand out with /</span>
    <span class="n">sub_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sub_dirs</span><span class="p">]</span>
    <span class="c1"># Mix the directory contents together</span>
    <span class="n">contents</span> <span class="o">=</span> <span class="n">sub_dirs</span> <span class="o">+</span> <span class="n">files</span>
    <span class="n">contents</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="c1"># Show the contents</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contents</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>This example shows a recursive directory listing.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_walk.py ../zipimport

../zipimport
  __init__.py
  example_package/
  index.rst
  zipimport_example.zip
  zipimport_find_module.py
  zipimport_get_code.py
  zipimport_get_data.py
  zipimport_get_data_nozip.py
  zipimport_get_data_zip.py
  zipimport_get_source.py
  zipimport_is_package.py
  zipimport_load_module.py
  zipimport_make_example.py

../zipimport/example_package
  README.txt
  __init__.py
</pre></div>
</div>
<p>If more information is needed than the names of the files, it is
likely to be more efficient to use <code class="docutils literal notranslate"><span class="pre">scandir()</span></code> than
<code class="docutils literal notranslate"><span class="pre">listdir()</span></code> because more information is collected in one system
call when the directory is scanned.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">os_scandir.py</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">scandir</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
        <span class="n">typ</span> <span class="o">=</span> <span class="s1">&#39;dir&#39;</span>
    <span class="k">elif</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="n">typ</span> <span class="o">=</span> <span class="s1">&#39;file&#39;</span>
    <span class="k">elif</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_symlink</span><span class="p">():</span>
        <span class="n">typ</span> <span class="o">=</span> <span class="s1">&#39;link&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">typ</span> <span class="o">=</span> <span class="s1">&#39;unknown&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{name}</span><span class="s1"> </span><span class="si">{typ}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">typ</span><span class="o">=</span><span class="n">typ</span><span class="p">,</span>
    <span class="p">))</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">scandir()</span></code> returns a sequence of <code class="docutils literal notranslate"><span class="pre">DirEntry</span></code> instances for
the items in the directory. The object has several attributes and
methods for accessing metadata about the file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_scandir.py .

index.rst file
os_access.py file
os_cwd_example.py file
os_directories.py file
os_environ_example.py file
os_exec_example.py file
os_fork_example.py file
os_kill_example.py file
os_listdir.py file
os_listdir.py~ file
os_process_id_example.py file
os_process_user_example.py file
os_rename_replace.py file
os_rename_replace.py~ file
os_scandir.py file
os_scandir.py~ file
os_spawn_example.py file
os_stat.py file
os_stat_chmod.py file
os_stat_chmod_example.txt file
os_strerror.py file
os_strerror.py~ file
os_symlinks.py file
os_system_background.py file
os_system_example.py file
os_system_shell.py file
os_wait_example.py file
os_waitpid_example.py file
os_walk.py file
</pre></div>
</div>
</div>
<div class="section" id="managing-file-system-permissions">
<span id="os-stat"></span><h2>Managing File System Permissions<a class="headerlink" href="#managing-file-system-permissions" title="Permalink to this headline">¶</a></h2>
<p>Detailed information about a file can be accessed using <code class="docutils literal notranslate"><span class="pre">stat()</span></code>
or <code class="docutils literal notranslate"><span class="pre">lstat()</span></code> (for checking the status of something that might be a
symbolic link).</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">os_stat.py</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="vm">__file__</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">stat_info</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;os.stat(</span><span class="si">{}</span><span class="s1">):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Size:&#39;</span><span class="p">,</span> <span class="n">stat_info</span><span class="o">.</span><span class="n">st_size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Permissions:&#39;</span><span class="p">,</span> <span class="nb">oct</span><span class="p">(</span><span class="n">stat_info</span><span class="o">.</span><span class="n">st_mode</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Owner:&#39;</span><span class="p">,</span> <span class="n">stat_info</span><span class="o">.</span><span class="n">st_uid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Device:&#39;</span><span class="p">,</span> <span class="n">stat_info</span><span class="o">.</span><span class="n">st_dev</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Created      :&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">stat_info</span><span class="o">.</span><span class="n">st_ctime</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Last modified:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">stat_info</span><span class="o">.</span><span class="n">st_mtime</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Last accessed:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">stat_info</span><span class="o">.</span><span class="n">st_atime</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The output will vary depending on how the example code was
installed. Try passing different filenames on the command line to
<code class="docutils literal notranslate"><span class="pre">os_stat.py</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_stat.py

os.stat(os_stat.py):
  Size: 593
  Permissions: 0o100644
  Owner: 527
  Device: 16777218
  Created      : Sat Dec 17 12:09:51 2016
  Last modified: Sat Dec 17 12:09:51 2016
  Last accessed: Sat Dec 31 12:33:19 2016

$ python3 os_stat.py index.rst

os.stat(index.rst):
  Size: 26878
  Permissions: 0o100644
  Owner: 527
  Device: 16777218
  Created      : Sat Dec 31 12:33:10 2016
  Last modified: Sat Dec 31 12:33:10 2016
  Last accessed: Sat Dec 31 12:33:19 2016
</pre></div>
</div>
<p>On Unix-like systems, file permissions can be changed using
<code class="docutils literal notranslate"><span class="pre">chmod()</span></code>, passing the mode as an integer. Mode values can be
constructed using constants defined in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">stat</span></code> module.  This
example toggles the user’s execute permission bit:</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">os_stat_chmod.py</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">stat</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;os_stat_chmod_example.txt&#39;</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;wt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;contents&#39;</span><span class="p">)</span>

<span class="c1"># Determine what permissions are already set using stat</span>
<span class="n">existing_permissions</span> <span class="o">=</span> <span class="n">stat</span><span class="o">.</span><span class="n">S_IMODE</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">st_mode</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">X_OK</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Adding execute permission&#39;</span><span class="p">)</span>
    <span class="n">new_permissions</span> <span class="o">=</span> <span class="n">existing_permissions</span> <span class="o">|</span> <span class="n">stat</span><span class="o">.</span><span class="n">S_IXUSR</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Removing execute permission&#39;</span><span class="p">)</span>
    <span class="c1"># use xor to remove the user execute permission</span>
    <span class="n">new_permissions</span> <span class="o">=</span> <span class="n">existing_permissions</span> <span class="o">^</span> <span class="n">stat</span><span class="o">.</span><span class="n">S_IXUSR</span>

<span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">new_permissions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The script assumes it has the permissions necessary to modify the mode
of the file when run.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_stat_chmod.py

Adding execute permission
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">access()</span></code> can be used to test the access rights a
process has for a file.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">os_access.py</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing:&#39;</span><span class="p">,</span> <span class="vm">__file__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exists:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">F_OK</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Readable:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">R_OK</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Writable:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">W_OK</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Executable:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">X_OK</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The results will vary depending on how the example code is installed,
but the output will be similar to this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_access.py

Testing: os_access.py
Exists: True
Readable: True
Writable: True
Executable: False
</pre></div>
</div>
<p>The library documentation for <code class="docutils literal notranslate"><span class="pre">access()</span></code> includes two special
warnings. First, there is not much sense in calling <code class="docutils literal notranslate"><span class="pre">access()</span></code> to
test whether a file can be opened before actually calling <code class="docutils literal notranslate"><span class="pre">open()</span></code>
on it. There is a small, but real, window of time between the two
calls during which the permissions on the file could change. The other
warning applies mostly to networked file systems that extend the POSIX
permission semantics. Some file system types may respond to the POSIX
call that a process has permission to access a file, then report a
failure when the attempt is made using <code class="docutils literal notranslate"><span class="pre">open()</span></code> for some reason
not tested via the POSIX call. All in all, it is better to call
<code class="docutils literal notranslate"><span class="pre">open()</span></code> with the required mode and catch the <code class="docutils literal notranslate"><span class="pre">IOError</span></code>
raised if there is a problem.</p>
</div>
<div class="section" id="creating-and-deleting-directories">
<span id="os-directories"></span><h2>Creating and Deleting Directories<a class="headerlink" href="#creating-and-deleting-directories" title="Permalink to this headline">¶</a></h2>
<p>There are several functions for working with directories on the file
system, including creating, listing contents, and removing them.</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">os_directories.py</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">dir_name</span> <span class="o">=</span> <span class="s1">&#39;os_directories_example&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Creating&#39;</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_name</span><span class="p">,</span> <span class="s1">&#39;example.txt&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Creating&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;wt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;example file&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cleaning up&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>There are two sets of functions for creating and deleting
directories. When creating a new directory with <code class="docutils literal notranslate"><span class="pre">mkdir()</span></code>, all of
the parent directories must already exist. When removing a directory
with <code class="docutils literal notranslate"><span class="pre">rmdir()</span></code>, only the leaf directory (the last part of the
path) is actually removed. In contrast, <code class="docutils literal notranslate"><span class="pre">makedirs()</span></code> and
<code class="docutils literal notranslate"><span class="pre">removedirs()</span></code> operate on all of the nodes in the path.
<code class="docutils literal notranslate"><span class="pre">makedirs()</span></code> will create any parts of the path that do not exist,
and <code class="docutils literal notranslate"><span class="pre">removedirs()</span></code> will remove all of the parent directories, as
long as they are empty.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_directories.py

Creating os_directories_example
Creating os_directories_example/example.txt
Cleaning up
</pre></div>
</div>
</div>
<div class="section" id="working-with-symbolic-links">
<h2>Working with Symbolic Links<a class="headerlink" href="#working-with-symbolic-links" title="Permalink to this headline">¶</a></h2>
<p>For platforms and file systems that support them, there are functions
for working with symlinks.</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">os_symlinks.py</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">link_name</span> <span class="o">=</span> <span class="s1">&#39;/tmp/&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Creating link </span><span class="si">{}</span><span class="s1"> -&gt; </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link_name</span><span class="p">,</span> <span class="vm">__file__</span><span class="p">))</span>
<span class="n">os</span><span class="o">.</span><span class="n">symlink</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="n">link_name</span><span class="p">)</span>

<span class="n">stat_info</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">lstat</span><span class="p">(</span><span class="n">link_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Permissions:&#39;</span><span class="p">,</span> <span class="nb">oct</span><span class="p">(</span><span class="n">stat_info</span><span class="o">.</span><span class="n">st_mode</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Points to:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">readlink</span><span class="p">(</span><span class="n">link_name</span><span class="p">))</span>

<span class="c1"># Cleanup</span>
<span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">link_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">symlink()</span></code> to create a symbolic link and <code class="docutils literal notranslate"><span class="pre">readlink()</span></code> for
reading it to determine the original file pointed to by the link.  The
<code class="docutils literal notranslate"><span class="pre">lstat()</span></code> function is like <code class="docutils literal notranslate"><span class="pre">stat()</span></code>, but operates on symbolic
links.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_symlinks.py

Creating link /tmp/os_symlinks.py -&gt; os_symlinks.py
Permissions: 0o120755
Points to: os_symlinks.py
</pre></div>
</div>
</div>
<div class="section" id="safely-replacing-an-existing-file">
<h2>Safely Replacing an Existing File<a class="headerlink" href="#safely-replacing-an-existing-file" title="Permalink to this headline">¶</a></h2>
<p>Replacing or renaming an existing file is not idempotent and may
expose applications to race conditions. The <code class="docutils literal notranslate"><span class="pre">rename()</span></code> and
<code class="docutils literal notranslate"><span class="pre">replace()</span></code> functions implement safe algorithms for these actions,
using atomic operations on POSIX-compliant systems when possible.</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">os_rename_replace.py</span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;rename_start.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;starting as rename_start.txt&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting:&#39;</span><span class="p">,</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;rename*.txt&#39;</span><span class="p">))</span>

<span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;rename_start.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;rename_finish.txt&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;After rename:&#39;</span><span class="p">,</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;rename*.txt&#39;</span><span class="p">))</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;rename_finish.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Contents:&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;rename_new_contents.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;ending with contents of rename_new_contents.txt&#39;</span><span class="p">)</span>

<span class="n">os</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;rename_new_contents.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;rename_finish.txt&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;rename_finish.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;After replace:&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>

<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;rename*.txt&#39;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">rename()</span></code> and <code class="docutils literal notranslate"><span class="pre">replace()</span></code> functions work across
filesystems, most of the time. Renaming a file may fail if it is being
moved to a new fileystem or if the destination already exists.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_rename_replace.py

Starting: [&#39;rename_start.txt&#39;]
After rename: [&#39;rename_finish.txt&#39;]
Contents: &#39;starting as rename_start.txt&#39;
After replace: &#39;ending with contents of rename_new_contents.txt&#39;
</pre></div>
</div>
</div>
<div class="section" id="detecting-and-changing-the-process-owner">
<h2>Detecting and Changing the Process Owner<a class="headerlink" href="#detecting-and-changing-the-process-owner" title="Permalink to this headline">¶</a></h2>
<p>The next set of functions provided by <code class="docutils literal notranslate"><span class="pre">os</span></code> are used for
determining and changing the process owner ids. These are most
frequently used by authors of daemons or special system programs that
need to change permission level rather than running as <code class="docutils literal notranslate"><span class="pre">root</span></code>. This
section does not try to explain all of the intricate details of Unix
security, process owners, etc. See the references list at the end of
this section for more details.</p>
<p>The following example shows the real and effective user and group
information for a process, and then changes the effective values. This
is similar to what a daemon would need to do when it starts as root
during a system boot, to lower the privilege level and run as a
different user.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Before running the example, change the <code class="docutils literal notranslate"><span class="pre">TEST_GID</span></code> and
<code class="docutils literal notranslate"><span class="pre">TEST_UID</span></code> values to match a real user defined on the system.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">os_process_user_example.py</span><a class="headerlink" href="#id11" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">TEST_GID</span> <span class="o">=</span> <span class="mi">502</span>
<span class="n">TEST_UID</span> <span class="o">=</span> <span class="mi">502</span>


<span class="k">def</span> <span class="nf">show_user_info</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;User (actual/effective)  : </span><span class="si">{}</span><span class="s1"> / </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">getuid</span><span class="p">(),</span> <span class="n">os</span><span class="o">.</span><span class="n">geteuid</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Group (actual/effective) : </span><span class="si">{}</span><span class="s1"> / </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">getgid</span><span class="p">(),</span> <span class="n">os</span><span class="o">.</span><span class="n">getegid</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Actual Groups   :&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getgroups</span><span class="p">())</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;BEFORE CHANGE:&#39;</span><span class="p">)</span>
<span class="n">show_user_info</span><span class="p">()</span>
<span class="nb">print</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">setegid</span><span class="p">(</span><span class="n">TEST_GID</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR: Could not change effective group. &#39;</span>
          <span class="s1">&#39;Rerun as root.&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CHANGE GROUP:&#39;</span><span class="p">)</span>
    <span class="n">show_user_info</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">seteuid</span><span class="p">(</span><span class="n">TEST_UID</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR: Could not change effective user. &#39;</span>
          <span class="s1">&#39;Rerun as root.&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CHANGE USER:&#39;</span><span class="p">)</span>
    <span class="n">show_user_info</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>When run as user with id of 502 and group 502 on OS X, this output is
produced:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_process_user_example.py

BEFORE CHANGE:
User (actual/effective)  : 527 / 527
Group (actual/effective) : 501 / 501
Actual Groups   : [501, 701, 402, 702, 500, 12, 61, 80, 98, 398,
399, 33, 100, 204, 395]

ERROR: Could not change effective group. Rerun as root.
ERROR: Could not change effective user. Rerun as root.
</pre></div>
</div>
<p>The values do not change because when it is not running as root, a
process cannot change its effective owner value. Any attempt to set
the effective user id or group id to anything other than that of the
current user causes an <code class="docutils literal notranslate"><span class="pre">OSError</span></code>.  Running the same script
using <code class="docutils literal notranslate"><span class="pre">sudo</span></code> so that it starts out with root privileges is a
different story.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo python3 os_process_user_example.py

BEFORE CHANGE:

User (actual/effective)  : 0 / 0
Group (actual/effective) : 0 / 0
Actual Groups : [0, 1, 2, 3, 4, 5, 8, 9, 12, 20, 29, 61, 80,
702, 33, 98, 100, 204, 395, 398, 399, 701]

CHANGE GROUP:
User (actual/effective)  : 0 / 0
Group (actual/effective) : 0 / 502
Actual Groups   : [0, 1, 2, 3, 4, 5, 8, 9, 12, 20, 29, 61, 80,
702, 33, 98, 100, 204, 395, 398, 399, 701]

CHANGE USER:
User (actual/effective)  : 0 / 502
Group (actual/effective) : 0 / 502
Actual Groups   : [0, 1, 2, 3, 4, 5, 8, 9, 12, 20, 29, 61, 80,
702, 33, 98, 100, 204, 395, 398, 399, 701]
</pre></div>
</div>
<p>In this case, since it starts as root, the script can change the
effective user and group for the process. Once the effective UID is
changed, the process is limited to the permissions of that user.
Because non-root users cannot change their effective group, the
program needs to change the group before changing the user.</p>
</div>
<div class="section" id="managing-the-process-environment">
<h2>Managing the Process Environment<a class="headerlink" href="#managing-the-process-environment" title="Permalink to this headline">¶</a></h2>
<p>Another feature of the operating system exposed to a program though
the <code class="docutils literal notranslate"><span class="pre">os</span></code> module is the environment. Variables set in the
environment are visible as strings that can be read through
<code class="docutils literal notranslate"><span class="pre">os.environ</span></code> or <code class="docutils literal notranslate"><span class="pre">getenv()</span></code>. Environment variables are
commonly used for configuration values such as search paths, file
locations, and debug flags. This example shows how to retrieve an
environment variable, and pass a value through to a child process.</p>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">os_environ_example.py</span><a class="headerlink" href="#id12" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Initial value:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TESTVAR&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Child process:&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;echo $TESTVAR&#39;</span><span class="p">)</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;TESTVAR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;THIS VALUE WAS CHANGED&#39;</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Changed value:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;TESTVAR&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Child process:&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;echo $TESTVAR&#39;</span><span class="p">)</span>

<span class="k">del</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;TESTVAR&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Removed value:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TESTVAR&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Child process:&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;echo $TESTVAR&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">os.environ</span></code> object follows the standard Python mapping API
for retrieving and setting values. Changes to <code class="docutils literal notranslate"><span class="pre">os.environ</span></code> are
exported for child processes.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -u os_environ_example.py

Initial value: None
Child process:


Changed value: THIS VALUE WAS CHANGED
Child process:
THIS VALUE WAS CHANGED

Removed value: None
Child process:
</pre></div>
</div>
</div>
<div class="section" id="managing-the-process-working-directory">
<h2>Managing the Process Working Directory<a class="headerlink" href="#managing-the-process-working-directory" title="Permalink to this headline">¶</a></h2>
<p>Operating systems with hierarchical file systems have a concept of the
<em>current working directory</em> – the directory on the file system the
process uses as the starting location when files are accessed with
relative paths.  The current working directory can be retrieved with
<code class="docutils literal notranslate"><span class="pre">getcwd()</span></code> and changed with <code class="docutils literal notranslate"><span class="pre">chdir()</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">os_cwd_example.py</span><a class="headerlink" href="#id13" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Moving up one:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">pardir</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pardir</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;After move:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">os.curdir</span></code> and <code class="docutils literal notranslate"><span class="pre">os.pardir</span></code> are used to refer to the
current and parent directories in a portable manner.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_cwd_example.py

Starting: .../pymotw-3/source/os
Moving up one: ..
After move: .../pymotw-3/source
</pre></div>
</div>
</div>
<div class="section" id="running-external-commands">
<span id="os-system"></span><h2>Running External Commands<a class="headerlink" href="#running-external-commands" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Many of these functions for working with processes have limited
portability. For a more consistent way to work with processes in a
platform independent manner, see the <a class="reference internal" href="../subprocess/index.html#module-subprocess" title="subprocess: Spawning additional processes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">subprocess</span></code></a> module
instead.</p>
</div>
<p>The most basic way to run a separate command, without interacting with
it at all, is <code class="docutils literal notranslate"><span class="pre">system()</span></code>. It takes a single string argument, which is
the command line to be executed by a sub-process running a shell.</p>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text">os_system_example.py</span><a class="headerlink" href="#id14" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Simple command</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;pwd&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The return value of <code class="docutils literal notranslate"><span class="pre">system()</span></code> is the exit value of the shell
running the program packed into a 16 bit number, with the high byte
the exit status and the low byte the signal number that caused the
process to die, or zero.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -u os_system_example.py

.../pymotw-3/source/os
</pre></div>
</div>
<p>Since the command is passed directly to the shell for processing, it can
include shell syntax such as globbing or environment variables.</p>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text">os_system_shell.py</span><a class="headerlink" href="#id15" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Command with shell expansion</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;echo $TMPDIR&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The environment variable <code class="docutils literal notranslate"><span class="pre">$TMPDIR</span></code> in this string is expanded when
the shell runs the command line.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -u os_system_shell.py

/var/folders/5q/8gk0wq888xlggz008k8dr7180000hg/T/
</pre></div>
</div>
<p>Unless the command is explicitly run in the background, the call to
<code class="docutils literal notranslate"><span class="pre">system()</span></code> blocks until it is complete. Standard input,
output, and error from the child process are tied to the appropriate
streams owned by the caller by default, but can be redirected using
shell syntax.</p>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text">os_system_background.py</span><a class="headerlink" href="#id16" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Calling...&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;date; (sleep 3; date) &amp;&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sleeping...&#39;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This is getting into shell trickery, though, and there are better ways to
accomplish the same thing.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -u os_system_background.py

Calling...
Sat Dec 31 12:33:20 EST 2016
Sleeping...
Sat Dec 31 12:33:23 EST 2016
</pre></div>
</div>
</div>
<div class="section" id="creating-processes-with-os-fork">
<span id="id1"></span><h2>Creating Processes with os.fork()<a class="headerlink" href="#creating-processes-with-os-fork" title="Permalink to this headline">¶</a></h2>
<p>The POSIX functions <code class="docutils literal notranslate"><span class="pre">fork()</span></code> and <code class="docutils literal notranslate"><span class="pre">exec()</span></code> (available under Mac
OS X, Linux, and other Unix variants) are exposed via the <code class="docutils literal notranslate"><span class="pre">os</span></code>
module. Entire books have been written about reliably using these
functions, so check the library or bookstore for more details than are
presented here in this introduction.</p>
<p>To create a new process as a clone of the current process, use
<code class="docutils literal notranslate"><span class="pre">fork()</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id17">
<div class="code-block-caption"><span class="caption-text">os_fork_example.py</span><a class="headerlink" href="#id17" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">pid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fork</span><span class="p">()</span>

<span class="k">if</span> <span class="n">pid</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Child process id:&#39;</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;I am the child&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The output will vary based on the state of the system each time the
example is run, but it will look something like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -u os_fork_example.py

Child process id: 29190
I am the child
</pre></div>
</div>
<p>After the fork, there are two processes running the same code. For a
program to tell which one it is in, it needs to check the return value
of <code class="docutils literal notranslate"><span class="pre">fork()</span></code>. If the value is <code class="docutils literal notranslate"><span class="pre">0</span></code>, the current process is the
child.  If it is not <code class="docutils literal notranslate"><span class="pre">0</span></code>, the program is running in the parent
process and the return value is the process id of the child process.</p>
<div class="literal-block-wrapper docutils container" id="id18">
<div class="code-block-caption"><span class="caption-text">os_kill_example.py</span><a class="headerlink" href="#id18" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">signal</span>
<span class="kn">import</span> <span class="nn">time</span>


<span class="k">def</span> <span class="nf">signal_usr1</span><span class="p">(</span><span class="n">signum</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
    <span class="s2">&quot;Callback invoked when a signal is received&quot;</span>
    <span class="n">pid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Received USR1 in process </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pid</span><span class="p">))</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Forking...&#39;</span><span class="p">)</span>
<span class="n">child_pid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fork</span><span class="p">()</span>
<span class="k">if</span> <span class="n">child_pid</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PARENT: Pausing before sending signal...&#39;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PARENT: Signaling </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">child_pid</span><span class="p">))</span>
    <span class="n">os</span><span class="o">.</span><span class="n">kill</span><span class="p">(</span><span class="n">child_pid</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">SIGUSR1</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CHILD: Setting up signal handler&#39;</span><span class="p">)</span>
    <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGUSR1</span><span class="p">,</span> <span class="n">signal_usr1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CHILD: Pausing to wait for signal&#39;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The parent can send signals to the child process using <code class="docutils literal notranslate"><span class="pre">kill()</span></code>
and the <a class="reference internal" href="../signal/index.html#module-signal" title="signal: Asynchronous system events"><code class="xref py py-mod docutils literal notranslate"><span class="pre">signal</span></code></a> module. First, define a signal handler to be
invoked when the signal is received.  Then <code class="docutils literal notranslate"><span class="pre">fork()</span></code>, and in the
parent pause a short amount of time before sending a <code class="docutils literal notranslate"><span class="pre">USR1</span></code>
signal using <code class="docutils literal notranslate"><span class="pre">kill()</span></code>. This example uses a short pause to give
the child process time to set up the signal handler. A real
application, would not need (or want) to call <code class="docutils literal notranslate"><span class="pre">sleep()</span></code>.  In the
child, set up the signal handler and go to sleep for a while to give
the parent time to send the signal.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -u os_kill_example.py

Forking...
PARENT: Pausing before sending signal...
CHILD: Setting up signal handler
CHILD: Pausing to wait for signal
PARENT: Signaling 29193
Received USR1 in process 29193
</pre></div>
</div>
<p>A simple way to handle separate behavior in the child process is to
check the return value of <code class="docutils literal notranslate"><span class="pre">fork()</span></code> and branch. More complex
behavior may call for more code separation than a simple branch. In
other cases, there may be an existing program that needs to be
wrapped. For both of these situations, the <code class="docutils literal notranslate"><span class="pre">exec*()</span></code> series
of functions can be used to run another program.</p>
<div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-text">os_exec_example.py</span><a class="headerlink" href="#id19" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">child_pid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fork</span><span class="p">()</span>
<span class="k">if</span> <span class="n">child_pid</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">waitpid</span><span class="p">(</span><span class="n">child_pid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">execlp</span><span class="p">(</span><span class="s1">&#39;pwd&#39;</span><span class="p">,</span> <span class="s1">&#39;pwd&#39;</span><span class="p">,</span> <span class="s1">&#39;-P&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>When a program is run by <code class="docutils literal notranslate"><span class="pre">exec()</span></code>, the code from that program replaces the
code from the existing process.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_exec_example.py

.../pymotw-3/source/os
</pre></div>
</div>
<p>There are many variations of <code class="docutils literal notranslate"><span class="pre">exec()</span></code>, depending on the form in
which the arguments are available, whether the path and environment of
the parent process should be copied to the child, etc.  For all
variations, the first argument is a path or filename and the remaining
arguments control how that program runs. They are either passed as
command line arguments or override the process “environment” (see
<code class="docutils literal notranslate"><span class="pre">os.environ</span></code> and <code class="docutils literal notranslate"><span class="pre">os.getenv</span></code>).  Refer to the library
documentation for complete details.</p>
</div>
<div class="section" id="waiting-for-child-processes">
<h2>Waiting for Child Processes<a class="headerlink" href="#waiting-for-child-processes" title="Permalink to this headline">¶</a></h2>
<p>Many computationally intensive programs use multiple processes to work
around the threading limitations of Python and the global interpreter
lock. When starting several processes to run separate tasks, the
master will need to wait for one or more of them to finish before
starting new ones, to avoid overloading the server. There are a few
different ways to do that using <code class="docutils literal notranslate"><span class="pre">wait()</span></code> and related functions.</p>
<p>When it does not matter which child process might exit first, use
<code class="docutils literal notranslate"><span class="pre">wait()</span></code>.  It returns as soon as any child process exits.</p>
<div class="literal-block-wrapper docutils container" id="id20">
<div class="code-block-caption"><span class="caption-text">os_wait_example.py</span><a class="headerlink" href="#id20" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PARENT </span><span class="si">{}</span><span class="s1">: Forking </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">(),</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">worker_pid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fork</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">worker_pid</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WORKER </span><span class="si">{}</span><span class="s1">: Starting&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WORKER </span><span class="si">{}</span><span class="s1">: Finishing&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PARENT: Waiting for </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="n">done</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PARENT: Child done:&#39;</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The return value from <code class="docutils literal notranslate"><span class="pre">wait()</span></code> is a tuple containing the process
id and exit status combined into a 16-bit value.  The low byte is the
number of the signal that killed the process, and the high byte is the
status code returned by the process when it exited.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -u os_wait_example.py

PARENT 29202: Forking 0
PARENT 29202: Forking 1
PARENT: Waiting for 0
WORKER 0: Starting
WORKER 1: Starting
WORKER 0: Finishing
PARENT: Child done: (29203, 0)
PARENT: Waiting for 1
WORKER 1: Finishing
PARENT: Child done: (29204, 256)
</pre></div>
</div>
<p>To wait for a specific process, use <code class="docutils literal notranslate"><span class="pre">waitpid()</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-text">os_waitpid_example.py</span><a class="headerlink" href="#id21" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">workers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PARENT </span><span class="si">{}</span><span class="s1">: Forking </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">(),</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">worker_pid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fork</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">worker_pid</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WORKER </span><span class="si">{}</span><span class="s1">: Starting&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WORKER </span><span class="si">{}</span><span class="s1">: Finishing&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">workers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">worker_pid</span><span class="p">)</span>

<span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">workers</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PARENT: Waiting for </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pid</span><span class="p">))</span>
    <span class="n">done</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">waitpid</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PARENT: Child done:&#39;</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Pass the process id of the target process, and <code class="docutils literal notranslate"><span class="pre">waitpid()</span></code> blocks
until that process exits.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -u os_waitpid_example.py

PARENT 29211: Forking 0
PARENT 29211: Forking 1
PARENT: Waiting for 29212
WORKER 0: Starting
WORKER 1: Starting
WORKER 0: Finishing
PARENT: Child done: (29212, 0)
PARENT: Waiting for 29213
WORKER 1: Finishing
PARENT: Child done: (29213, 256)
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">wait3()</span></code> and <code class="docutils literal notranslate"><span class="pre">wait4()</span></code> work in a similar manner, but return
more detailed information about the child process with the pid, exit
status, and resource usage.</p>
</div>
<div class="section" id="spawning-new-processes">
<h2>Spawning New Processes<a class="headerlink" href="#spawning-new-processes" title="Permalink to this headline">¶</a></h2>
<p>As a convenience, the <code class="docutils literal notranslate"><span class="pre">spawn()</span></code> family of functions handles the
<code class="docutils literal notranslate"><span class="pre">fork()</span></code> and <code class="docutils literal notranslate"><span class="pre">exec()</span></code> in one statement:</p>
<div class="literal-block-wrapper docutils container" id="id22">
<div class="code-block-caption"><span class="caption-text">os_spawn_example.py</span><a class="headerlink" href="#id22" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">spawnlp</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">P_WAIT</span><span class="p">,</span> <span class="s1">&#39;pwd&#39;</span><span class="p">,</span> <span class="s1">&#39;pwd&#39;</span><span class="p">,</span> <span class="s1">&#39;-P&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The first argument is a mode indicating whether or not to wait for the
process to finish before returning.  This example waits.  Use
<code class="docutils literal notranslate"><span class="pre">P_NOWAIT</span></code> to let the other process start, but then resume in
the current process.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_spawn_example.py

.../pymotw-3/source/os
</pre></div>
</div>
</div>
<div class="section" id="operating-system-error-codes">
<h2>Operating System Error Codes<a class="headerlink" href="#operating-system-error-codes" title="Permalink to this headline">¶</a></h2>
<p>Error codes defined by the operating system and managed in the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">errno</span></code> module can be translated to message strings using
<code class="docutils literal notranslate"><span class="pre">strerror()</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id23">
<div class="code-block-caption"><span class="caption-text">os_strerror.py</span><a class="headerlink" href="#id23" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">errno</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="p">[</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span> <span class="n">errno</span><span class="o">.</span><span class="n">EINTR</span><span class="p">,</span> <span class="n">errno</span><span class="o">.</span><span class="n">EBUSY</span><span class="p">]:</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">errno</span><span class="o">.</span><span class="n">errorcode</span><span class="p">[</span><span class="n">num</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">{num:&gt;2}</span><span class="s1">] </span><span class="si">{name:&lt;6}</span><span class="s1">: </span><span class="si">{msg}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">num</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<p>This example shows the messages associated with some error codes that
come up frequently.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 os_strerror.py

[ 2] ENOENT: No such file or directory
[ 4] EINTR : Interrupted system call
[16] EBUSY : Resource busy
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://docs.python.org/3.7/library/os.html">Standard library documentation for os</a></li>
<li><a class="reference internal" href="../porting_notes.html#porting-os"><span class="std std-ref">Python 2 to 3 porting notes for os</span></a></li>
<li><a class="reference internal" href="../signal/index.html#module-signal" title="signal: Asynchronous system events"><code class="xref py py-mod docutils literal notranslate"><span class="pre">signal</span></code></a> – The section on the <code class="docutils literal notranslate"><span class="pre">signal</span></code> module goes over
signal handling techniques in more detail.</li>
<li><a class="reference internal" href="../subprocess/index.html#module-subprocess" title="subprocess: Spawning additional processes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">subprocess</span></code></a> – The <code class="docutils literal notranslate"><span class="pre">subprocess</span></code> module supersedes
<code class="docutils literal notranslate"><span class="pre">os.popen()</span></code>.</li>
<li><a class="reference internal" href="../multiprocessing/index.html#module-multiprocessing" title="multiprocessing: Manage processes like threads."><code class="xref py py-mod docutils literal notranslate"><span class="pre">multiprocessing</span></code></a> – The <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> module makes
working with extra processes easier.</li>
<li><a class="reference internal" href="../tempfile/index.html#module-tempfile" title="tempfile: Temporary file system objects"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tempfile</span></code></a> – The <code class="docutils literal notranslate"><span class="pre">tempfile</span></code> module for working with
temporary files.</li>
<li><a class="reference internal" href="../shutil/index.html#shutil-directory-functions"><span class="std std-ref">Working With Directory Trees</span></a> – The <a class="reference internal" href="../shutil/index.html#module-shutil" title="shutil: High-level file operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">shutil</span></code></a> module
also includes functions for working with directory trees.</li>
<li><a class="reference external" href="http://www.ibm.com/developerworks/aix/library/au-speakingunix8/index.html">Speaking UNIX,
Part 8.</a>
– Learn how UNIX multitasks.</li>
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Standard_streams">Standard streams</a>
– For more discussion of stdin, stdout, and stderr.</li>
<li><a class="reference external" href="http://www.ibm.com/developerworks/aix/library/au-unixprocess.html">Delve into Unix Process Creation</a>
– Explains the life cycle of a Unix process.</li>
<li><em>Advanced Programming in the UNIX(R) Environment</em> By W. Richard
Stevens and Stephen A. Rago.  Published by Addison-Wesley
Professional, 2005.  ISBN-10: 0201433079 – This book covers
working with multiple processes, such as handling signals,
closing duplicated file descriptors, etc.</li>
</ul>
</div>
</div>
</div>



        <div id="footer-nav">
<a id="prev-link" href="../sys/tracing.html"
   title="previous chapter"><i class="fa fa-arrow-circle-left"></i> Tracing a Program As It Runs</a>
<a id="next-link" href="../platform/index.html"
   title="next chapter">platform — System Version Information <i class="fa fa-arrow-circle-right"></i></a>
        </div>

        </div>
      </div>

      <div class="pure-u-1-4">
        <div class="sidebar-wrapper">
          <div class="sidebar">
<div id="sidebar-toc">
  <h5>Quick Links</h5>
  <ul>
    
    <li><a href="#examining-the-file-system-contents"><i class="fa fa-caret-right"></i>Examining the File System Contents</a></li>
    
    <li><a href="#managing-file-system-permissions"><i class="fa fa-caret-right"></i>Managing File System Permissions</a></li>
    
    <li><a href="#creating-and-deleting-directories"><i class="fa fa-caret-right"></i>Creating and Deleting Directories</a></li>
    
    <li><a href="#working-with-symbolic-links"><i class="fa fa-caret-right"></i>Working with Symbolic Links</a></li>
    
    <li><a href="#safely-replacing-an-existing-file"><i class="fa fa-caret-right"></i>Safely Replacing an Existing File</a></li>
    
    <li><a href="#detecting-and-changing-the-process-owner"><i class="fa fa-caret-right"></i>Detecting and Changing the Process Owner</a></li>
    
    <li><a href="#managing-the-process-environment"><i class="fa fa-caret-right"></i>Managing the Process Environment</a></li>
    
    <li><a href="#managing-the-process-working-directory"><i class="fa fa-caret-right"></i>Managing the Process Working Directory</a></li>
    
    <li><a href="#running-external-commands"><i class="fa fa-caret-right"></i>Running External Commands</a></li>
    
    <li><a href="#creating-processes-with-os-fork"><i class="fa fa-caret-right"></i>Creating Processes with os.fork()</a></li>
    
    <li><a href="#waiting-for-child-processes"><i class="fa fa-caret-right"></i>Waiting for Child Processes</a></li>
    
    <li><a href="#spawning-new-processes"><i class="fa fa-caret-right"></i>Spawning New Processes</a></li>
    
    <li><a href="#operating-system-error-codes"><i class="fa fa-caret-right"></i>Operating System Error Codes</a></li>
    
  </ul>
</div>

          </div>
          <div class="sidebar"><div id="sidebar-last-updated">
  This page was last updated 2018-03-18.
</div>

          </div>
          <div class="sidebar">
<div id="sidebar-nav">
  <h5>Navigation</h5>
  <ul>
    <li><a href="../sys/tracing.html"
           title="previous chapter"><i class="fa fa-arrow-circle-left"></i>Tracing a Program As It Runs</a></li>
    <li><a href="../platform/index.html"
           title="next chapter"><i class="fa fa-arrow-circle-right"></i>platform — System Version Information</a></li>
  </ul>
</div>
          </div>
          <div class="sidebar"><div id="sidebar-book"><a target="new" href="https://doughellmann.com/blog/the-python-3-standard-library-by-example/"><img src="../_static/book-cover-image-med.jpg"><br>Get the book</a></div>
          </div>
          <div class="sidebar"><div id="sidebar-example-disclaimer">
<p>The output from all the example programs
from PyMOTW-3 has been generated with Python 3.7.9, unless
otherwise noted. Some of the features described here may not be
available in earlier versions of Python.</p>
<p>Looking for <a href="/2/">examples for Python 2</a>?</p>
</div>
          </div>

        </div>
      </div>

    </div>

    <div class="pure-g-r" id="footer">

      <div class="pure-u-1-3">
        <div class="footer-list">
            <h4>This Site</h4>
            <ul>
              <li><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
              <li><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
            </ul>
        </div>
      </div><div class="pure-u-1-3">
          <div class="footer-content">
            <div class="socialmedia">
              <a class="sociallink" href="../index.html"
       title="Home">
      <i class="fa fa-home fa-lg"></i></a>
              <a class="sociallink" href="../about.html"
       title="About">
      <i class="fa fa-user fa-lg"></i></a>
              <a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a>
              <a class="sociallink" href="http://feeds.doughellmann.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a>
              <a class="sociallink" href="http://feedburner.google.com/fb/a/mailverify?uri=PyMOTW&amp;loc=en_US"
       title="Subscribe via Email">
      <i class="fa fa-envelope fa-lg"></i></a>
            </div>

            <div class="copyright">
              <a rel="author" href="../about.html">&copy; Copyright 2021, Doug Hellmann</a>
            </div>

            <div class="cc"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.en_US" rel="license"><img alt="Creative Commons License BY-NC-SA" style="border-width:0; align: center;" width="88" height="31" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAfCAMAAABUFvrSAAAABGdBTUEAALGOfPtRkwAAAf5QTFRF////////////AAAADQwNDQ4NDg4OEBAQGRkZGxsbHxscICAgIx8gJCQkKCUmKCgoKCkoKSkpKSopKicnKioqLS0tMDAwMS0uMjExMjMxNTY1Pj8+Pzc5Pzs8QEBAQ0RDUFBQUFFQWldYXV5dYGBgY19haGVmbmxscHBwcHJvdXJzdnN0eHV2eXx5en15fH98fX98fnt8f4F+gICAgoWChIGChIWEhIaEh4aHiYyJjIqLjoeLj4+PkY+PkZORkZSRk5iTlZmUlpmWmJaXmpiZnp2dnqCdn5aan5+fn6Oeoqaho6Gho6ijpqqmq7GqrKurrLKrrbOsrrOtrrStr6+vr7Kvr7Sur7WusLOvsLWvsLavsbewsrexsrixs7iytLmztLqztbW1tbq0tru1t7y2uL23ub64ub65urm5ur+5ur+6u8C6u8C7vMC8vMG7vMG8vcK8vcK9vsK9vsO+v7+/v8O+v8S+wMS/wMW/wMXAwcXAwsfCw8fCw8jDxMfDxMjDxMnExcnExcnFxsrFxsrGx8vHyMfHyMzHyMzIycjIyc3Iyc3Jys3Jy8rLy87Ky8/Ky8/LzM/LzNDLzNDMzdDMzdHMzdHNztHNztLOz8/Pz9PP0NPP0NTQ0dTQ0dTR0tXR0tXS09bS1tXV39/f4N/g4+Pj6Ofn7+/v8fHx////rrSdFQAAAAN0Uk5TAAoO5yEBUwAAA+FJREFUSMe1lo9301QUx6uXUmaf0qJ26iTrRoVinUzjQNR1gAyH6Lqx6XTDoVvXbU7qhA5m7CgYWaTDlLa6AiFsba3t+y+9Sdr8OvVMi7zTnLTf5H7ee9/73n11PA1PpDkcADPRWPwKt8YLG2I2n89m7gh8iluJz0dnpqe+HBsdHRn+7w3JyF1cvpbk05mCJG8Xi9uPpMLdNJ9cXV5UyBNjoyMtkR2A3B9Tt8SCfLTTqUzC2XlMvpcRbnA/IPmryYnzoyM9XuWBt8eI21FBcAy5Qk4KtxkGtQ1I+fRNbnk+evHC5NhJDwATDDIAnhNa1ImdFQTHr6WEvNyFPFeATSTYgAu/dl3/I31jNR6bnZ76eDf4yxRb2Q+71aiz/0JB8JXkrZzCdbFVqrUhRHuu54XkytLczAUvBFADUB6ARwnyqEp/t02prK9XdAXBHC9KyPWVqd6qPhyzlOG55dhsL/hLDTD1A3rYAy+dRu6eXaGKruA75wi2hbqigNd+LYSRW6XUSh64l05dXYruA1OPZfAOD3vhObL/ILDvQkRXynSdvPpaiJB+TVHAfEZuA9d9amlVF7TJd3nu+xgwyu8AqNOnDGAM8/obOLhQpWQotPYReZ/SQdKuKQpY2DwKwFJbGwI4VhCSlxchSFUnNC+CCgaV9RAKoZKh1J4le9FmQv5SFQW88aATXGhEws8wrHb7AANc0CndQS+ag5ERaieke0FXvnkxoYL/1MGi7FSmmVBXMDOu3gLK5J2PMjdXv2tmBX6pDdKSkq39DWXh3G1KI4QYVmS3AHCIPnCXE+4hHy6PcfeQ6sV2lufiL2jJ0wasp4p2k/Z2CEXeeqahDBLS1/c8+dBIXq4IkFAiWQ1QtxtnUMz/wsXfBj+1LzdUKn17dvXXzEqfMoFDNWO57QCe22dskKB5g7zXbVN+i0RKumKxonrfzaIVys2wYu7TVrd0PXn1rOnJC4JTFjF5c19/gnXLFwj6jJJz1rOjoi63LnBRfbmNM+qNunG5baSufhu9OPX5my2VTWEzrHrRbIP8dHl+dnpyrIVDBME/q1u6/E9bGmt9i2AsQmeaFaFwIb22soSlfuL8SEtgOCJKB5BsKkNltWyK7zzWMY3X4exDc6GvsljoX5FzR+BxwdCbf3jAdjTJv5/S39H2B2iXpmgXpWB7iVrB0JuVzpgP07CUO2WKqX+oiVL/benKImhgOIzHf7hx/A/IBdHsQ6Nsmruilo4afVFqB8PLn2U2H8hbxeKWjH9YvuiwxNiMaNhALZptCg5d7zh+Sczmclnx0vEOax6ajdjucSMPTcD/97/Cp54Q929ZZbgcR3o0hAAAAABJRU5ErkJggg=="/></a>
            </div>

          </div></div><div class="pure-u-1-3">
          <div class="footer-list">
            <h4>Other Writing</h4>
            <ul>
              <li><a href="https://doughellmann.com/"><i class="fa fa-pencil fa-lg"></i> Blog</a></li>
              <li><a href="https://doughellmann.com/blog/the-python-standard-library-by-example/"><i class="fa fa-book fa-lg"></i> The Python Standard Library By Example</a></li>
            </ul>
          </div>
        </div><script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38546875-3', 'pymotw.com');
  ga('send', 'pageview');
</script>

  </body>
</html>